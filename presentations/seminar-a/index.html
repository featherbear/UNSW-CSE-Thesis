<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<title>Seminar A | Andrew Wong</title>
<meta name=description content="Musings of a CSE Thesis">
<meta name=apple-mobile-web-app-capable content="yes">
<meta name=apple-mobile-web-app-status-bar-style content="black-translucent">
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<link rel=stylesheet href=../../reveal-js/css/reset.css>
<link rel=stylesheet href=../../reveal-js/css/reveal.css>
<link rel=stylesheet href=../../_.min.a230c4a7a1567dd6102968d8163a8141477da8488849428e390a8cd00a44c5a7.css id=theme><link rel=stylesheet href=../../highlight-js/default.min.css>
</head>
<body>
<div class=reveal>
<div class=slides>
<section data-noprocess data-shortcode-slide data-background-image=https://featherbear.cc/UNSW-CSE-Thesis/uploads/20211030_040050.jpg data-transition=fade>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br></p>
<h3 id=smart-vacuum-cleaners>&ldquo;Smart&rdquo; Vacuum Cleaners</h3>
<h5 id=an-audit-into-the-security-and-integrity-of-iot-systems>An Audit Into The Security and Integrity of IoT Systems</h5>
<h6 id=andrew-wong--unsw-sydney>Andrew Wong | UNSW Sydney</h6>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<h1 id=introduction>Introduction</h1>
<p>Internet of Things (IoT) and Smart Home devices are everywhere.</p>
<span class=fragment><p>Q: Can we completely trust a device&rsquo;s {security, privacy}?<br>
A: <label>no</label></p>
</span>
<span class=fragment><hr>
<ul>
<li>Developers are humans.
<ul>
<li>Humans make mistakes.
<ul>
<li>Developers make <s>mistakes</s> bugs</li>
</ul>
</li>
</ul>
</li>
<li>Or maybe secret company agendas?</li>
</ul>
</span>
<span class=fragment><p><label>We should always verify and test things where possible!</label></p>
</span>
<aside class=notes><p>The Internet of Things (IoT) and Smart Home devices are everywhere&mldr;<br>
From smart lightbulbs, to smart fridges&mldr; to &mldr; [*] smart &mldr; flip-flops?
We can&rsquo;t seem live without them, but should we really be living <em>with</em> them?</p>
<p>Now regardless of where you stand in the pro or anti smart device debate, the matter of fact is that the adoption of these devices into our daily lives have been widespread.</p>
<p>Of course though, everything comes at a cost.</p>
</aside>
</section><section>
<h1 id=about-me>About Me</h1>
<style>.profileBanner{width:100%;height:280px;background-image:url(https://featherbear.cc/assets/images/cover.jpg);background-position:100% 30%;background-size:cover;position:relative;box-shadow:none;margin:1em 0;border-radius:10px}.profileBanner::before{content:' ';position:absolute;inset:0;z-index:-1;background:inherit;filter:blur(.2em)}</style>
<p><strong>Andrew Wong</strong><br>
Computer Engineering @ UNSW Sydney</p>
<sub>
e: <script>document.write(atob('YW5kcmV3Lmoud29uZ0BzdHVkZW50LnVuc3cuZWR1LmF1'))</script>
<p><label>Interests</label></br>
Making things, breaking things&mldr; mainly the latter
</sub></p>
<div class=profileBanner></div>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br></p>
<h1 id=background-information>Background Information</h1>
</section><section>
<h1 id=background-information-1>Background Information</h1>
<h5 id=widespread-availability-of-iot-brands>Widespread availability of IoT brands</h5>
<section data-shortcode-section>
<p><img src=../../uploads/20211103-screely-1635938406254.png alt></p>
</section><section>
<ul>
<li>IoT manufacturers sell their products to vendors
<ul>
<li>The product itself</li>
<li>Cloud infrastructure</li>
<li>Smartphone application</li>
</ul>
</li>
<li>White-label vendors buy a generic product
<ul>
<li>Rebrand and sell products under their name</li>
</ul>
</li>
</ul>
<style>.marquee-parent{position:relative;width:100vw;max-width:100%;height:200px;overflow-x:hidden;border-radius:10px}.marquee-child{position:absolute;white-space:nowrap;will-change:transform;max-width:unset!important;max-height:100%!important;animation:marquee 360s linear infinite}.marquee-child:hover{animation-play-state:paused}@keyframes marquee{from{transform:translateX(0)}to{transform:translateX(-87.5%)}}</style>
<p><br></p>
<div class=marquee-parent><img src=../../uploads/20211115-lightbulbs-marquee.png class=marquee-child></div>
</section><section>
<blockquote>
Vulnerabilities in IoT infrastructure<br>=<br> Vulnerability in all white-label products
</blockquote>
</section>
</section><section>
<h1 id=background-information-2>Background Information</h1>
<h5 id=centralisation-and-iot-manufacturers-as-data-giants>Centralisation and IoT Manufacturers as &ldquo;Data Giants&rdquo;</h5>
<section data-shortcode-section>
<ul>
<li>Same IoT cloud infrastructure used by white-label vendors</li>
<li>Data and network activity is all centralised / standardised</li>
<li>Privacy concerns - Who, What, Where, When, Why?</li>
<li>Infrastructure outage = really <em>really</em> big outage..</li>
</ul>
<p><img src=../../uploads/20211115-spof.gif width=30% alt=center></p>
</section><section>
<ul>
<li>Reverse engineering of cloud communications protocols / API
<ul>
<li>e.g. MiIO protocol <a href=https://github.com/OpenMiHome/mihome-binary-protocol>(link)</a></li>
</ul>
</li>
<li>Decoupling of devices from the necessity of internet / IoT cloud
<ul>
<li><label>HomeAssistant</label> - Home Automation <a href=https://www.home-assistant.io/>(link)</a></li>
<li><label>OpenHAB</label> - Home Automation <a href=https://www.openhab.org/>(link)</a></li>
<li><label>Valetudo</label> - Cloud-less vacuum cleaner control interface <a href=https://github.com/Hypfer/Valetudo>(link)</a></li>
<li><label>DustCloud</label> - Xiaomi Cloud Emulation <a href=https://github.com/dgiese/dustcloud>(link)</a></li>
<li><label>MiCloudFaker</label> - Xiaomi Cloud Emulation <a href=https://github.com/unrelentingtech/micloudfaker>(link)</a></li>
<li><label>tuya-convert</label> - Flash Tuya devices to custom firmware <a href=https://github.com/ct-Open-Source/tuya-convert>(link)</a></li>
</ul>
</li>
</ul>
</section>
</section><section>
<h1 id=about-the-company>About The Company</h1>
<p><img src=../../uploads/20211003-60410b5d26ef2b00045692ec.png class="plain small"></p>
<section data-shortcode-section>
</section><section>
<ul>
<li>Robotic home cleaning appliances</li>
<li>Founded in July 2014, Beijing</li>
<li>Partnered with Xiaomi in September 2014
<ul>
<li>Investments + Partnership</li>
</ul>
</li>
</ul>
</section><section>
<ul>
<li>September 2016 - Mi Home Robotic Vaccuum Cleaner
<ul>
<li>Very first product!</li>
</ul>
</li>
<li>‚ãÆ Roborock S5, E2, E3</li>
<li>June 2019 - <label>Roborock S6</label></li>
<li>‚ãÆ Roborock S5 Max, S4, S6 Pure, S6 MaxV, E4, S4 Max</li>
<li>January 2021 - S7</li>
</ul>
</section>
</section><section>
<h1 id=about-the-device>About The Device</h1>
<h3 id=roborock-s6-vacuum-cleaner>Roborock S6 Vacuum Cleaner</h3>
<section data-shortcode-section>
<p><img src=../../uploads/20211103-s6-pure-banner.webp alt></p>
</section><section>
<h5 id=specifications>Specifications</h5>
<ul>
<li>CPU: Allwinner R16 Quad-core ARMv7</li>
<li>ACU: STM32F103VC</li>
<li>RAM: 512 MB</li>
<li>Flash: 4 GB eMMC</li>
<li>Wireless: RTL8189ETV (802.11 b/g/n)</li>
<li>Cloud: Tuya / Xiaomi</li>
<li>OS: Ubuntu 14.04</li>
</ul>
</section><section>
<h4 id=cloud-capability>Cloud Capability</h4>
<div class=split2>
<div>
<label>Roborock (Xiaomi Cloud)</label>
<p><img src=../../uploads/20211103%20-%20Snipaste_2021-11-03_21-47-05.jpg alt></p>
</div>
<div>
<label>Tuya Cloud</label>
<p><img src=../../uploads/20211103%20-%20Snipaste_2021-11-03_21-48-02.jpg alt></p>
</div>
</div>
</section><section>
<p>IoT infrastructure vulnerability (<a href=https://global.roborock.com/pages/disclosure-security-vulnerability-on-tuya-iot-cloud>15/09/2021</a>)</p>
<p><img src=../../uploads/20211103-screely-1635941373424-highlight.png alt></p>
</section>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<h1 id=statement>Statement</h1>
<blockquote>
</blockquote>
<p>How have manufacturers of IoT / smart home devices addressed the increasing concerns of digital privacy and product security?</p>
<blockquote>
</blockquote>
<section data-shortcode-section>
</section><section>
<h1 id=rationale>Rationale</h1>
<blockquote>
<p>üîê Security is important!</p>
</blockquote>
<blockquote>
<p>üìí Check things for yourself!</p>
</blockquote>
</section>
</section><section>
<h1 id=proposal>Proposal</h1>
<blockquote>
<p>Digital Privacy</p>
</blockquote>
<p>Investigate the nature of network data (i.e. content, frequency, destination) from the Roborock S6, and how the data is used.</p>
<hr>
<blockquote>
<p>Product Security</p>
</blockquote>
<p>Investigate potential security vulnerabilities of the Roborock S6, and assess the effectiveness of current security fortifications.</p>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br></p>
<h1 id=literature-review>Literature Review</h1>
<h4 id=existing-works-and-papers>Existing Works and Papers</h4>
</section><section>
<h1 id=literature-review-1>Literature Review</h1>
<section data-shortcode-section>
<p><br>
<br>
<br>
<br>
<br></p>
<h2 id=iot->IoT ‚òÅ</h2>
<p>The majority of hardware hacks / custom firmwares have originated from the desire to decouple hardware from cloud services</p>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<h5 id=iot--2018---michael-steigerwald-vtrust>IoT | 2018 - Michael Steigerwald (VTRUST)</h5>
<blockquote>
<p>Talk: <a href=https://media.ccc.de/v/35c3-9723-smart_home_-_smart_hack>Smart home - Smart hack</a></p>
</blockquote>
<ul>
<li>Products from different manufacturers used the same cloud infrastructure each with their own &lsquo;customised&rsquo; (white-label) smartphone apps
<ul>
<li>Supposed &lsquo;military-grade security&rsquo;</li>
</ul>
</li>
<li>Used the <a style="text-decoration:underline dotted" href=https://www.espressif.com/en/products/socs/esp8266>Espressif ESP8266</a> chip
<ul>
<li>WiFi-enabled SoC with Arduino support</li>
<li>Often used by tinkerers and enthusiasts</li>
</ul>
</li>
<li>Anyone can become an &lsquo;IoT company&rsquo; regardless of &ldquo;having in-depth technical knowledge of IoT or IT security.&rdquo;
<ul>
<li>üö©üö©üö©</li>
</ul>
</li>
</ul>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<h5 id=iot--2018---michael-steigerwald-vtrust-1>IoT | 2018 - Michael Steigerwald (VTRUST)</h5>
<blockquote>
<p>Talk: <a href=https://media.ccc.de/v/35c3-9723-smart_home_-_smart_hack>Smart home - Smart hack</a></p>
</blockquote>
<p><em>&ldquo;The analysis of the &lsquo;smart&rsquo; devices using this basic platform is generally frightening [&mldr;] serious [&mldr;] shortcomings&rdquo;</em></p>
<ul>
<li>Insecure transmission of encryption keys, serial number, etc&mldr;</li>
<li>Insecure transmission of wireless credentials during pairing</li>
<li>Ease of white-labelling and starting your own IoT business
<ul>
<li>Ease of selling malicious devices</li>
</ul>
</li>
</ul>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<h5 id=iot--2018---michael-steigerwald-vtrust-2>IoT | 2018 - Michael Steigerwald (VTRUST)</h5>
<blockquote>
<p>Talk: <a href=https://media.ccc.de/v/35c3-9723-smart_home_-_smart_hack>Smart home - Smart hack</a></p>
</blockquote>
<p><a href=https://github.com/ct-Open-Source/tuya-convert><img src="https://gh-card.dev/repos/ct-Open-Source/tuya-convert.svg?fullname=" alt=center></a></p>
<p>Automated flashing tool <code>tuya-convert</code> created that exploited prior vulnerabilities to flash custom decoupled firmware<br>
(i.e. <a href=https://esphome.io/>ESPhome</a>, <a href=https://tasmota.github.io/docs/>Tasmota</a>, etc&mldr;)</p>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<h5 id=iot--2018---michael-steigerwald-vtrust-3>IoT | 2018 - Michael Steigerwald (VTRUST)</h5>
<blockquote>
<p>Tuya&rsquo;s Response</p>
</blockquote>
<ul>
<li>28th January 2019 - <a href=https://www.heise.de/newsticker/meldung/Smart-Home-Hack-Tuya-veroeffentlicht-Sicherheitsupdate-4292028.html>patch</a> released <em>(later subverted)</em>
<ul>
<li>TLS encrypted firmware update procedure</li>
<li>Encryption of flash memory</li>
</ul>
</li>
<li>3rd January 2020 - <a href=https://github.com/ct-Open-Source/tuya-convert/issues/483>new patch</a> released
<ul>
<li>unbreakable‚Ñ¢</li>
</ul>
</li>
<li>23rd April 2020 - Switched from the ESP8266 to a custom SoC
<ul>
<li><a href=https://github.com/ct-Open-Source/tuya-convert/issues/483>Tuya WB3S</a></li>
</ul>
</li>
<li>16th June 2021 - Announced official support for HomeAssistant</li>
</ul>
</section><section>
<h5 id=iot--20172018---xiaomi-dafang-hacks>IoT | 2017/2018 - Xiaomi Dafang Hacks</h5>
<p><a href=https://github.com/EliasKotlyar/Xiaomi-Dafang-Hacks><img src="https://gh-card.dev/repos/EliasKotlyar/Xiaomi-Dafang-Hacks.svg?fullname=" alt=center></a> <a href=https://github.com/samtap/fang-hacks><img src="https://gh-card.dev/repos/samtap/fang-hacks.svg?fullname=" alt=center></a></p>
<ul>
<li>Cheap WiFi camera that can be made to boot off a microSD card</li>
<li>Circuit board exposed UART (<code>baud_rate=115200</code>) pins that allowed interaction with U-Boot bootloader</li>
<li>Modification of boot environment to start <code>/bin/sh</code> (<a href=https://github.com/EliasKotlyar/Xiaomi-Dafang-Hacks/blob/master/hacks/getroot.md>[link]</a>)</li>
<li>Gain root shell access</li>
<li>Dump firmware</li>
<li>Analyse, modify and package updated firmware</li>
</ul>
</section><section>
<p><br>
<br>
<br>
<br>
<br></p>
<h2 id=access-and-control>Access and Control</h2>
<p>Gaining access to a shell / stored data / things we shouldn&rsquo;t.</p>
</section><section>
<h5 id=flash-ic-dumping>Flash IC Dumping</h5>
<p><img src=http://www.saelig.com/miva/graphics/00000001/848pro725_350x189.jpg alt=center></p>
<ul>
<li>May require a proprietary flash programmer (above: US$3655)</li>
<li>Budget solution for common flash types: Raspberry Pi (AU$100)</li>
<li>Some flash chips (depending on form factor) may require to be desoldered
<ul>
<li>üß® Possibly a destructive process üß®</li>
</ul>
</li>
<li>Open-source software: <a href=https://www.flashrom.org/Flashrom><code>flashrom</code></a></li>
</ul>
<blockquote>
<p>Source: <a href=https://jcjc-dev.com/2016/06/08/reversing-huawei-4-dumping-flash/>J. Jimenez - Practical Reverse Engineering</a></p>
</blockquote>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<h5 id=bga-shorting-to-gain-access-to-fel>BGA shorting to gain access to FEL</h5>
<p><img src=../../uploads/20211115-boot-sequence.png height=300px alt=center></p>
<ul>
<li>FEL mode is a &ldquo;fallback&rdquo; system on Allwinner SoCs</li>
<li>Allows the flashing and reprogramming of the SoC</li>
<li>Generally triggered by pulling
<a href=https://linux-sunxi.org/images/b/b3/R16_Datasheet_V1.4_(1).pdf style="text-decoration:underline dotted">FEL pin</a> (<code>LRADC0</code>) LOW during boot</li>
<li>FEL mode can also be entered if the bootloader fails to load ü§î</li>
</ul>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<h5 id=bga-shorting-to-gain-access-to-fel-1>BGA shorting to gain access to FEL</h5>
<ul>
<li>On the Allwinner R16 (BGA package) FEL pin located on ball location <code>L14</code>
<ul>
<li>Not located on package edge the chip so <label>desoldering required</label></li>
</ul>
</li>
</ul>
<blockquote>
<p>Enter FEL mode by preventing (e)MMC load?</p>
</blockquote>
<ul>
<li>SoC has a solder plane height of around 0.3mm</li>
<li>Too shallow for a wire, but tall enough for aluminium foil&mldr;</li>
</ul>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<h5 id=bga-shorting-to-gain-access-to-fel-2>BGA shorting to gain access to FEL</h5>
<p><label>Aluminium Foil</label></p>
<p><img src=../../uploads/20211115-Snipaste_2021-11-15_19-45-37-dgiese.jpg height=300px alt=center></p>
<ul>
<li>Thickness: ~0.02mm (&mldr; 0.02mm &#171; 0.3mm)</li>
<li>Conductive: Yep!</li>
<li>$$$</li>
</ul>
<p>Documented: <a href=https://dontvacuum.me/thesis/Security_Analysis_of_the_Xiaomi_IoT_Ecosystem.pdf><code>SEEMOO-MSC-0142</code></a></p>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<h5 id=bga-shorting-to-gain-access-to-fel--aside-2021>BGA shorting to gain access to FEL | Aside (2021)</h5>
<blockquote>
<p>On later versions (post 2020), U-Boot shell access was patched, so shell access via UART was mitigated</p>
</blockquote>
<p>Pin TPA17 on the Roborock S7 circuit board was <a href=https://dontvacuum.me/talks/DEFCON29/DEFCON29-vacuum-robots.pdf>discovered</a> to connect to ball location L14 on the SoC.</p>
<p>Therefore by pulling TPA17 / L14 / LRADC0 LOW (i.e connect to GND), FEL mode can be entered</p>
</section>
<section data-noprocess data-shortcode-slide data-transition="slide-in fade-out">
<h5 id=vacuums-in-the-cloud-analyzing-security-in-a-hardened-iot-ecosystem>Vacuums in the Cloud: Analyzing Security in a Hardened IoT Ecosystem</h5>
<blockquote>
<p>Presentation: <a href=https://www.usenix.org/conference/woot19/presentation/ullrich>USENIX WOOT 19</a></p>
</blockquote>
<ul>
<li>Security analysis performed on a Neato BotVac Connected robot vacuum cleaner (popular in the US)</li>
<li>AM335x Microprocessor (ARM Cortex-A8)</li>
<li>Cold-boot attack allowed RAM to be dumped over serial
<ul>
<li><label>Cold-boot attack</label> - restarting the system whilst keeping memory modules powered on, keeping memory (mostly) in-tact</li>
<li>USB + Serial communication allowed boot into custom image that could then dump the memory for later triage</li>
</ul>
</li>
</ul>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<h5 id=vacuums-in-the-cloud-analyzing-security-in-a-hardened-iot-ecosystem-1>Vacuums in the Cloud: Analyzing Security in a Hardened IoT Ecosystem</h5>
<ul>
<li>Memory dumps contained confidential keys
<ul>
<li>üôã‚Äç‚ôÄÔ∏è Auth/Authz to the robot</li>
<li>üôÜ‚Äç‚ôÄÔ∏è Auth/Authz to the cloud infrastructure</li>
</ul>
</li>
<li>Logs and coredumps were encrypted&mldr; but keys hardcoded</li>
<li>Secret key RNG algorithm determined to be weak
<ul>
<li>Small keyspace given known data = bruteforceable</li>
</ul>
</li>
<li>RSA key was shared with all devices üîì
<ul>
<li>Identity impersonation</li>
</ul>
</li>
</ul>
<blockquote>
<p>Also discovered <label>buffer overflow</label> vulnerability in an unauthenticated stage.</p>
</blockquote>
</section>
<section data-noprocess data-shortcode-slide data-transition="slide-in fade-out">
<h5 id=2014---firmware-analysis>2014 - Firmware Analysis</h5>
<blockquote>
<p>Paper: <a href=https://www.usenix.org/node/184450.>A Large-Scale Analysis of the Security of Embedded Firmwares</a></p>
</blockquote>
<ul>
<li>Broad analysis of a large number of firmware images</li>
<li>Discovered 38 new vulnerabilities over 693 images</li>
<li>Similarities in vulnerabilities</li>
<li>Static analysis and extraction of keys, credentials, configurations and other &lsquo;tells&rsquo;</li>
</ul>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<h5 id=2014---firmware-analysis-1>2014 - Firmware Analysis</h5>
<ul>
<li>Source code changes largely remain the same</li>
<li>But binary files change &lsquo;arbitrarily&rsquo;</li>
<li>Difficult to compare binary files</li>
<li>Calculate fuzzy hashes instead to compare similarity</li>
</ul>
<p>e.g. <a href=https://github.com/ReFirmLabs/binwalk>binwalk</a>, <a href=https://github.com/ssdeep-project/ssdeep>ssdeep</a>, <a href=https://github.com/sdhash/sdhash>sdhash</a></p>
</section><section>
<h5 id=client-side-and-infrastructural-security>Client-Side and Infrastructural Security</h5>
<blockquote>
<p>iOS application of a smart doorlock was analysed to (in)validate claims made by the device company</p>
</blockquote>
<p><label>Findings</label></p>
<ul>
<li>Lock events and other sensitive information were being logged independent of locking functionality</li>
<li>Access to lock settings were purely client-side UI checks</li>
<li>Certificate pinning bypass-able</li>
</ul>
<p>Source: <a href=https://media.defcon.org/DEF%20CON%2024/DEF%20CON%2024%20presentations/DEF%20CON%2024%20-%20Jmaxxz-Backdooring-the-Frontdoor-UPDATED.pdf>Backdooring the Frontdoor</a></p>
</section>
<section data-noprocess data-shortcode-slide data-transition="slide-in fade-out">
<h5 id=lidar---acoustic-eavesdropping>LIDAR - Acoustic Eavesdropping</h5>
<blockquote>
<p>LIDAR - Light Detection and Ranging</p>
</blockquote>
<ul>
<li>Uses laser lights to sense distance</li>
<li>Side-channel also exposes intensity (on some units)
<ul>
<li>Can use to detect minute vibrations induced by audio sources</li>
</ul>
</li>
</ul>
<p><img src="https://eak2mvmpt4a.exactdn.com/wp-content/uploads/2020/07/A-Guide-to-Lidar-Wavelengths-Velodyne-Lidar-AlphaPrime-1.jpg?strip=all&lossy=1&ssl=1" alt></p>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<h5 id=lidar---acoustic-eavesdropping-1>LIDAR - Acoustic Eavesdropping</h5>
<ul>
<li>Vibrations are extracted and turned back into sound waves
<ul>
<li>Extraction of sensitive data (i.e. credit card digits)</li>
<li>Achieved 91% classification accuracy</li>
</ul>
</li>
</ul>
<p>2015: <a href=https://dl.acm.org/doi/10.1145/2789168.2790119>Acoustic Eavesdropping through Wireless Vibrometry</a><br>
2020: <a href=https://dl.acm.org/doi/10.1145/3384419.3430430>LidarPhone: acoustic eavesdropping using a lidar sensor</a></p>
<p><img src="https://www.zdnet.com/a/img/resize/cdaf0753c4b991623b9413270b0d9ceff8a6e730/2020/11/19/2f9e0e96-c3e5-4cdc-b9bb-24022efd5b3b/lidarphone.png?fit=bounds&auto=webp" alt=center></p>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<h5 id=xiaomi-ecosystem--2017-2019---dennis-giese>Xiaomi Ecosystem | 2017-2019 - Dennis Giese</h5>
<blockquote>
<p>Paper: <a href=https://dontvacuum.me/thesis/Security_Analysis_of_the_Xiaomi_IoT_Ecosystem.pdf><code>SEEMOO-MSC-0142</code></a> (July 10, 2019)</p>
</blockquote>
<ul>
<li>Research available: <a href=https://dontvacuum.me>dontvacuum.me</a></li>
<li>Performed security analysis of a range of Xiaomi products</li>
<li>Found ways to root the Mi Home Robotic Vacuum Cleaner and the Roborock S6
<ul>
<li>UART, hardware fault injection, etc&mldr;</li>
</ul>
</li>
<li>Developed cloud emulation software (<a href=https://github.com/dgiese/dustcloud>DustCloud</a>)</li>
<li>Research led to development of 3rd party software (i.e. <a href=https://github.com/Hypfer/Valetudo>Valeduto</a>)</li>
</ul>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<h5 id=xiaomi-ecosystem--2017-2019---dennis-giese-1>Xiaomi Ecosystem | 2017-2019 - Dennis Giese</h5>
<blockquote>
<p>&ldquo;How secure is the implementation of the ecosystem of the IoT market leader Xiaomi?&rdquo;</p>
</blockquote>
<p><label>Conclusions</label></p>
<ul>
<li>‚åö The company quickly responds to security concerns</li>
<li>üîç Many exposed endpoints of deprecated APIs</li>
<li>üîì Many devices do not enforce proper HTTPS checks</li>
<li>ü§ù Difficult to enforce security for plugins (vendor-provided)</li>
<li>‚ùì CIA principles generally kept</li>
</ul>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<h5 id=xiaomi-ecosystem--2017-2019---dennis-giese-2>Xiaomi Ecosystem | 2017-2019 - Dennis Giese</h5>
<blockquote>
<p>More to be done</p>
</blockquote>
<p><img src=../../uploads/20211110-screely-1636466635263.png alt></p>
</section>
</section><section>
<h1 id=extrapolation>Extrapolation</h1>
<blockquote>
<p>Previous Achievements</p>
</blockquote>
<ul>
<li>Smartphone application reverse engineering</li>
<li>Device firmware interception</li>
<li>Device hardware and component identification</li>
<li>Network traffic analysis</li>
<li>Storage analysis</li>
</ul>
<blockquote>
<p>Unaddressed Areas</p>
</blockquote>
<ul>
<li>Post-2019 replication study</li>
<li>In-depth firmware analysis</li>
</ul>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br></p>
<h1 id=plan>Plan</h1>
</section><section>
<h1 id=plan-1>Plan</h1>
<section data-shortcode-section>
<ul>
<li>Research</li>
<li>Get the Roborock S6 vacuum cleaner</li>
<li>Acquisition and capture of network activity</li>
<li>Find a way in (it runs Linux!)</li>
<li>Image the system for offline analysis</li>
<li>Reverse engineering and binary analysis of firmware and software
<ul>
<li>Look through binaries for security vulnerabilities and fortifications</li>
</ul>
</li>
</ul>
</section><section>
<h3 id=considerations>Considerations</h3>
<ul>
<li>I&rsquo;m just a fourth year!
<ul>
<li>Limited skills</li>
<li>i.e. microsoldering for flash chip extraction and dumping</li>
</ul>
</li>
<li>Access to equipment and facilities are limited (COVID?)</li>
<li>Only have one device to test on</li>
</ul>
</section><section>
<h3 id=contingency>Contingency</h3>
<p><label>If we can&rsquo;t get into the device?</label></p>
<ul>
<li>
<p>Option 1 - Protocol analysis (network traffic)</p>
<ul>
<li>i.e. Inspect the data and its nature
<ul>
<li>Content, Frequency, Destination</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Option 2 - Investigate the <img src=../../uploads/20211103-xiaomi-home-logo.png height=24px> <a href="https://play.google.com/store/apps/details?id=com.xiaomi.smarthome" style="text-decoration:underline dotted">Xiaomi Home</a> smartphone application (used to communicate with the device)</p>
<ul>
<li>i.e. Decompile the Android APK file and look for security vulnerabilities and fortifications</li>
</ul>
</li>
</ul>
</section><section>
<h3 id=future-plans>Future Plans</h3>
<ul>
<li>See what the sensors see</li>
<li>Circuit board decomposition</li>
<li>Analyse the custom ADB binary serving the USB port</li>
</ul>
</section>
</section><section>
<h1 id=research-upskill-tooling>Research, Upskill, Tooling</h1>
<blockquote>
<p>Research areas as of initial exploration</p>
</blockquote>
<ul>
<li>How to capture network activity <label>without</label> compromising my home network?</li>
<li>Interfacing with JTAG / UART / Serial</li>
<li>Linux filesystem / system forensics</li>
<li>Learn the ARM Instruction Set (ISA)
<ul>
<li>Processor Modes, Protection Rings?</li>
</ul>
</li>
<li>Learn about other hardware protections
<ul>
<li>Secure Boot, RPBM, SELinux, LUKS, OPTEE, TrustZone, etc&mldr;</li>
</ul>
</li>
<li>Acquisition of hardware
<ul>
<li>Serial adapters?</li>
<li>Network switch?</li>
<li>etc&mldr;</li>
</ul>
</li>
</ul>
<aside class=notes><ul>
<li>Isolated Network</li>
<li>VLAN?</li>
<li>Port Mirroring / Packet Sniffing</li>
<li>Wireshark</li>
</ul>
</aside>
</section><section>
<h1 id=project-timeline>Project Timeline</h1>
<h4 id=labelthesis-alabel><label>Thesis A</label></h4>
<ul>
<li>Initial research and research environment setup</li>
<li>Teardown and initial hands-on of Roborock S6</li>
</ul>
<h4 id=labelthesis-b---binary-assessmentlabel><label>Thesis B - Binary Assessment</label></h4>
<ul>
<li>Disassembly and analysis of firmware binaries to identify vulnerabilities
<ul>
<li>inc. ADB binary functionality</li>
</ul>
</li>
<li>Search for unsecured secrets, logs, configurations</li>
</ul>
<h4 id=labelthesis-c---connectivity-assessmentlabel><label>Thesis C - Connectivity Assessment</label></h4>
<ul>
<li>Inspection of outbound internet traffic - security, PII, etc</li>
<li>Inspection of local network traffic</li>
<li>Inspection of interaction with nearby devices</li>
<li>Protocol analysis</li>
</ul>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br></p>
<h1 id=current-progress>Current Progress</h1>
</section><section>
<h1 id=rolling-research>Rolling Research</h1>
<section data-shortcode-section>
<blockquote>
<p><a href=https://featherbear.cc/UNSW-CSE-Thesis/>featherbear.cc/UNSW-CSE-Thesis</a></p>
</blockquote>
<p><a href=https://featherbear.cc/UNSW-CSE-Thesis/><img src=../../uploads/20211103-screely-1635868857938.png alt></a></p>
</section><section>
<blockquote>
<p><a href=https://featherbear.cc/UNSW-CSE-Thesis/tldr>Summary</a></p>
</blockquote>
<p><a href=https://featherbear.cc/UNSW-CSE-Thesis/tldr><img src=../../uploads/20211103-screely-1635869059154.png alt></a></p>
</section>
</section><section>
<h1 id=preliminary-results>Preliminary Results</h1>
<section data-shortcode-section>
<h3 id=network-setup>Network Setup</h3>
<p><img src=../../uploads/20211027-20211026_210111-highlighted.jpg alt></p>
</section><section>
<h3 id=initial-packet-capture>[Initial] Packet Capture</h3>
<p><img src=../../uploads/20211025-snipaste_2021-10-26_02-04-58.jpg alt></p>
<ul>
<li>No LAN-LAN packets???</li>
<li><label>incomplete test</label> - misconfigured packet capture setup</li>
</ul>
</section><section>
<h3 id=teardown>Teardown</h3>
<p><img src=../../uploads/20211029-20211029_233611.jpg alt></p>
</section><section>
<h3 id=initial-breakdown-and-pinout-where-needed>Initial Breakdown and Pinout (where needed)</h3>
<p><img src=../../uploads/20211029-20211030_021531.jpg alt></p>
<aside class=notes><p>STM32, Allwinner R16 (Quad-core ARMv7 processor), USB Port (custom ADB?)</p>
</aside>
</section><section>
<h3 id=identification-of-the-uart-pins>Identification of the UART pins</h3>
<p><img src=../../uploads/20211029-20211030_021507-uart-highlighted.jpg alt></p>
</section><section>
<h3 id=serial-access>Serial Access</h3>
<ul>
<li>Serial (baud=115200) gives us a shell!</li>
</ul>
<p><img src=../../uploads/20211029-20211030_025959.jpg width=33.5%>
<img src=../../uploads/20211103-serial-comms.gif width=60%></p>
<blockquote>
<p>Need a root password though&mldr;</p>
</blockquote>
</section><section>
<h3 id=u-boot-bootloader>U-Boot Bootloader</h3>
<p><img src=../../uploads/20211103-Snipaste_2021-11-03_03-47-40.jpg alt></p>
<ul>
<li>Able to enter the bootloader shell if <code>s</code> is pressed during init</li>
</ul>
<p><img src=../../uploads/20211029-bootloader-shell.jpg alt></p>
</section><section>
<h3 id=root>Root!</h3>
<p><img src=../../uploads/20211029-snipaste_2021-10-30_03-24-41.jpg alt></p>
<p><img src=../../uploads/20211029-snipaste_2021-10-30_03-26-11.jpg alt></p>
</section>
</section><section>
<h1 id=next-steps>Next Steps</h1>
<ul>
<li>Dump the firmware and begin RE / forensics</li>
<li>Redo (and further investigate) live system analysis
<ul>
<li>i.e. Properly capture <em>all</em> network traffic</li>
</ul>
</li>
</ul>
</section><section>
<h1 id=any-questions>Any Questions?</h1>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br></p>
<hr>
<p>Andrew Wong</p>
<sub>
<p>w: <a href=https://featherbear.cc/UNSW-CSE-Thesis>featherbear.cc/UNSW-CSE-Thesis</a></p>
<p>e: <script>document.write(atob('YW5kcmV3Lmoud29uZ0BzdHVkZW50LnVuc3cuZWR1LmF1'))</script></p>
</sub></section>
</div>
</div>
<script type=text/javascript src=../../reveal-hugo/object-assign.js></script>
<a href=../../reveal-js/css/print/ id=print-location style=display:none></a>
<script type=text/javascript>var printLocationElement=document.getElementById('print-location'),link=document.createElement('link');link.rel='stylesheet',link.type='text/css',link.href=printLocationElement.href+(window.location.search.match(/print-pdf/gi)?'pdf.css':'paper.css'),document.getElementsByTagName('head')[0].appendChild(link)</script>
<script type=application/json id=reveal-hugo-site-params>{"center":false,"custom_theme":"presentations/theme.scss","custom_theme_compile":true,"dependencies":[{"src":"../plugins/capsLockKeymod.js"}],"history":true,"pdf_separate_fragments":true,"slide_number":true,"width":1024}</script>
<script type=application/json id=reveal-hugo-page-params>null</script>
<script src=../../reveal-js/js/reveal.js></script>
<script type=text/javascript>var revealHugoDefaults,revealHugoSiteParams,revealHugoPageParams,options;function camelize(a){return a&&Object.keys(a).forEach(function(b){newK=b.replace(/(\_\w)/g,function(a){return a[1].toUpperCase()}),newK!=b&&(a[newK]=a[b],delete a[b])}),a}revealHugoDefaults={center:!0,controls:!0,history:!0,progress:!0,transition:"slide"},revealHugoSiteParams=JSON.parse(document.getElementById('reveal-hugo-site-params').innerHTML),revealHugoPageParams=JSON.parse(document.getElementById('reveal-hugo-page-params').innerHTML),options=Object.assign({},camelize(revealHugoDefaults),camelize(revealHugoSiteParams),camelize(revealHugoPageParams)),Reveal.initialize(options)</script>
<script type=text/javascript src=../../reveal-js/plugin/markdown/marked.js></script>
<script type=text/javascript src=../../reveal-js/plugin/markdown/markdown.js></script>
<script type=text/javascript src=../../reveal-js/plugin/highlight/highlight.js></script>
<script type=text/javascript src=../../reveal-js/plugin/zoom-js/zoom.js></script>
<script type=text/javascript src=../../reveal-js/plugin/notes/notes.js></script>
<script type=text/javascript>for(let a of document.querySelectorAll(".reveal .slides > section"))a.dataset.transition||(a.dataset.transition="fade-out slide-in");document.querySelectorAll('p img').forEach(b=>{if(b.alt!='center')return;let a=b;while(a.tagName!='P')a=a.parentNode;a.style.textAlign='center'})</script>
</body>
</html>