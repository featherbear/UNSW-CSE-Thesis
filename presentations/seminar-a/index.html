<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<title>Seminar A | Andrew Wong</title>
<meta name=description content="Musings of a CSE Thesis">
<meta name=apple-mobile-web-app-capable content="yes">
<meta name=apple-mobile-web-app-status-bar-style content="black-translucent">
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<link rel=stylesheet href=../../reveal-js/css/reset.css>
<link rel=stylesheet href=../../reveal-js/css/reveal.css>
<link rel=stylesheet href=../../_.min.7d694823d2d9d1ee48251589ba394b2e82b7846e813e97bb6ffd80beb2eca778.css id=theme><link rel=stylesheet href=../../highlight-js/default.min.css>
</head>
<body>
<div class=reveal>
<div class=slides>
<section data-noprocess data-shortcode-slide data-background-image=https://featherbear.cc/UNSW-CSE-Thesis/uploads/20211030_040050.jpg data-transition=fade>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br></p>
<h3 id=smart-vacuum-cleaners>&ldquo;Smart&rdquo; Vacuum Cleaners</h3>
<h5 id=an-audit-into-the-security-and-integrity-of-iot-systems>An Audit Into The Security and Integrity of IoT Systems</h5>
<h6 id=andrew-wong--unsw-sydney>Andrew Wong | UNSW Sydney</h6>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<h1 id=introduction>Introduction</h1>
<p>Internet of Things (IoT) and Smart Home devices are everywhere.</p>
<span class=fragment><p>Q: Can we completely trust a device&rsquo;s {security, privacy}?<br>
A: <label>no</label></p>
</span>
<span class=fragment><hr>
<ul>
<li>Developers are humans.
<ul>
<li>Humans make mistakes.
<ul>
<li>Developers make <s>mistakes</s> bugs</li>
</ul>
</li>
</ul>
</li>
<li>Or maybe secret company agendas?</li>
</ul>
</span>
<span class=fragment><p><label>We should always verify and test things where possible!</label></p>
</span>
<aside class=notes><p>The Internet of Things (IoT) and Smart Home devices are everywhere&mldr;<br>
From smart lightbulbs, to smart fridges&mldr; to &mldr; [*] smart &mldr; flip-flops?
We can&rsquo;t seem live without them, but should we really be living <em>with</em> them?</p>
<p>Now regardless of where you stand in the pro or anti smart device debate, the matter of fact is that the adoption of these devices into our daily lives have been widespread.</p>
<p>Of course though, everything comes at a cost.</p>
</aside>
</section><section>
<h1 id=about-me>About Me</h1>
<style>.profileBanner{width:100%;height:280px;background-image:url(https://featherbear.cc/assets/images/cover.jpg);background-position:100% 30%;background-size:cover;position:relative;box-shadow:none;margin:1em 0;border-radius:10px}.profileBanner::before{content:' ';position:absolute;inset:0;z-index:-1;background:inherit;filter:blur(.2em)}</style>
<p><strong>Andrew Wong</strong><br>
Computer Engineering @ UNSW Sydney</p>
<sub>
e: <script>document.write(atob('YW5kcmV3Lmoud29uZ0BzdHVkZW50LnVuc3cuZWR1LmF1'))</script>
<p><label>Interests</label></br>
Making things, breaking things&mldr; mainly the latter
</sub></p>
<div class=profileBanner></div>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br></p>
<h1 id=background-information>Background Information</h1>
</section><section>
<h1 id=background-information-1>Background Information</h1>
<h5 id=widespread-availability-of-iot-brands>Widespread availability of IoT brands</h5>
<section data-shortcode-section>
<p><img src=../../uploads/20211103-screely-1635938406254.png alt></p>
</section><section>
<ul>
<li>IoT manufacturers sell their products to vendors
<ul>
<li>The product itself</li>
<li>Cloud infrastructure</li>
<li>Smartphone application</li>
</ul>
</li>
<li>White-label vendors buy a generic product
<ul>
<li>Rebrand and sell products under their name</li>
</ul>
</li>
</ul>
</section><section>
<blockquote>
Vulnerabilities in IoT infrastructure<br>=<br> Vulnerability in all white-label products
</blockquote>
</section>
</section><section>
<h1 id=background-information-2>Background Information</h1>
<h5 id=centralisation-and-iot-manufacturers-as-data-giants>Centralisation and IoT Manufacturers as &ldquo;Data Giants&rdquo;</h5>
<section data-shortcode-section>
<ul>
<li>Same IoT cloud infrastructure used by white-label vendors</li>
<li>Data and network activity is all centralised / standardised</li>
<li>Privacy concerns?
<ul>
<li>Who, What, Where, When, Why?</li>
</ul>
</li>
</ul>
<blockquote>
IoT infrastructure outage<br>=<br>Product-wide outage
</blockquote>
</section><section>
<ul>
<li>Reverse engineering of cloud communications protocols / API
<ul>
<li>e.g. MiIO protocol <a href=https://github.com/OpenMiHome/mihome-binary-protocol>(link)</a></li>
</ul>
</li>
<li>Decoupling of devices from the necessity of internet / IoT cloud
<ul>
<li><label>HomeAssistant</label> - Home Automation <a href=https://www.home-assistant.io/>(link)</a></li>
<li><label>OpenHAB</label> - Home Automation <a href=https://www.openhab.org/>(link)</a></li>
<li><label>Valetudo</label> - Cloud-less vacuum cleaner control inferface <a href=https://github.com/Hypfer/Valetudo>(link)</a></li>
<li><label>DustCloud</label> - Xiaomi Cloud Emulation <a href=https://github.com/dgiese/dustcloud>(link)</a></li>
<li><label>MiCloudFaker</label> - Xiaomi Cloud Emulation <a href=https://github.com/unrelentingtech/micloudfaker>(link)</a></li>
<li><label>tuya-convert</label> - Flash Tuya devices to custom firmware <a href=https://github.com/ct-Open-Source/tuya-convert>(link)</a></li>
</ul>
</li>
</ul>
</section>
</section><section>
<h1 id=about-the-company>About The Company</h1>
<p><img src=../../uploads/20211003-60410b5d26ef2b00045692ec.png class="plain small"></p>
<section data-shortcode-section>
</section><section>
<ul>
<li>Robotic home cleaning appliances</li>
<li>Founded in July 2014, Beijing</li>
<li>Partnered with Xiaomi in September 2014
<ul>
<li>Investments + Partnership</li>
</ul>
</li>
</ul>
</section><section>
<ul>
<li>September 2016 - Mi Home Robotic Vaccuum Cleaner
<ul>
<li>Very first product!</li>
</ul>
</li>
<li>⋮ Roborock S5, E2, E3</li>
<li>June 2019 - <label>Roborock S6</label></li>
<li>⋮ Roborock S5 Max, S4, S6 Pure, S6 MaxV, E4, S4 Max</li>
<li>January 2021 - S7</li>
</ul>
</section>
</section><section>
<h1 id=about-the-device>About The Device</h1>
<h3 id=roborock-s6-vacuum-cleaner>Roborock S6 Vacuum Cleaner</h3>
<section data-shortcode-section>
<p><img src=../../uploads/20211103-s6-pure-banner.webp alt></p>
</section><section>
<h5 id=specifications>Specifications</h5>
<ul>
<li>CPU: Allwinner R16 Quad-core ARMv7</li>
<li>ACU: STM32F103VC</li>
<li>RAM: 512 MB</li>
<li>Flash: 4 GB eMMC</li>
<li>Wireless: RTL8189ETV (802.11 b/g/n)</li>
<li>Cloud: Tuya / Xiaomi</li>
<li>OS: Ubuntu 14.04</li>
</ul>
</section><section>
<h4 id=cloud-capability>Cloud Capability</h4>
<div class=split2>
<div>
<label>Roborock (Xiaomi Cloud)</label>
<p><img src=../../uploads/20211103%20-%20Snipaste_2021-11-03_21-47-05.jpg alt></p>
</div>
<div>
<label>Tuya Cloud</label>
<p><img src=../../uploads/20211103%20-%20Snipaste_2021-11-03_21-48-02.jpg alt></p>
</div>
</div>
</section><section>
<p>IoT infrastructure vulnerability (<a href=https://global.roborock.com/pages/disclosure-security-vulnerability-on-tuya-iot-cloud>15/09/2021</a>)</p>
<p><img src=../../uploads/20211103-screely-1635941373424-highlight.png alt></p>
</section>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<h1 id=statement>Statement</h1>
<blockquote>
</blockquote>
<p>How have manufacturers of IoT / smart home devices addressed the increasing concerns of digital privacy and product security?</p>
<blockquote>
</blockquote>
<section data-shortcode-section>
</section><section>
<h1 id=rationale>Rationale</h1>
<blockquote>
<p>Security is important!</p>
</blockquote>
<blockquote>
<p>Check things for yourself!</p>
</blockquote>
</section>
</section><section>
<h1 id=proposal>Proposal</h1>
<blockquote>
<p>Digital Privacy</p>
</blockquote>
<p>Investigate the nature of network data (i.e. content, frequency, destination) from the Roborock S6, and how the data is used.</p>
<hr>
<blockquote>
<p>Product Security</p>
</blockquote>
<p>Investigate potential security vulnerabilities of the Roborock S6, and assess the effectiveness of current security fortifications.</p>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br></p>
<h1 id=literature-review>Literature Review</h1>
<h4 id=existing-works-and-papers>Existing Works and Papers</h4>
</section><section>
<h1 id=literature-review-1>Literature Review</h1>
<section data-shortcode-section>
<blockquote>
<p>2017 - Dennis Giese</p>
</blockquote>
<ul>
<li>Found ways to root the Mi Home Robotic Vacuum Cleaner and the Roborock S6</li>
<li><a href=https://dontvacuum.me>https://dontvacuum.me</a></li>
<li>Continued analysis on later Xiaomi (and derivative) vacuum cleaners</li>
</ul>
<p>Dustcloud</p>
<p>TODO: OTHER PAPERS</p>
</section>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br></p>
<h1 id=plan>Plan</h1>
</section><section>
<h1 id=plan-1>Plan</h1>
<section data-shortcode-section>
<ul>
<li>Research</li>
<li>Get the Roborock S6 vacuum cleaner</li>
<li>Acquisition and capture of network activity</li>
<li>Find a way in (it runs Linux!)</li>
<li>Image the system for offline analysis</li>
<li>Reverse engineering and binary analysis of firmware and software
<ul>
<li>Look through binaries for security vulnerabilities and fortifications</li>
</ul>
</li>
</ul>
</section><section>
<h3 id=contingency>Contingency</h3>
<p><label>If we can&rsquo;t get into the device?</label></p>
<ul>
<li>
<p>Option 1 - Protocol analysis (network traffic)</p>
<ul>
<li>i.e. Inspect the data and its nature
<ul>
<li>Content, Frequency, Destination</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Option 2 - Investigate the <img src=../../uploads/20211103-xiaomi-home-logo.png height=24px> <a href="https://play.google.com/store/apps/details?id=com.xiaomi.smarthome" style="text-decoration:underline dotted">Xiaomi Home</a> smartphone application (used to communicate with the device)</p>
<ul>
<li>i.e. Decompile the Android APK file and look for security vulnerabilities and fortifications</li>
</ul>
</li>
</ul>
</section><section>
<h3 id=future-plans>Future Plans</h3>
<ul>
<li>See what the sensors see</li>
<li>Circuit board decomposition</li>
<li>Analyse the custom ADB binary serving the USB port</li>
</ul>
</section>
</section><section>
<h1 id=research-upskill-tooling>Research, Upskill, Tooling</h1>
<blockquote>
<p>Research areas as of initial exploration</p>
</blockquote>
<ul>
<li>How to capture network activity <label>without</label> compromising my home network?</li>
<li>Interfacing with JTAG / UART / Serial</li>
<li>Linux filesystem / system forensics</li>
<li>Learn the ARM Instruction Set (ISA)
<ul>
<li>Processor Modes, Protection Rings?</li>
</ul>
</li>
<li>Acquisition of hardware
<ul>
<li>Serial adapters?</li>
<li>Network switch?</li>
<li>etc&mldr;</li>
</ul>
</li>
</ul>
<aside class=notes><ul>
<li>Isolated Network</li>
<li>VLAN?</li>
<li>Port Mirroring / Packet Sniffing</li>
<li>Wireshark</li>
</ul>
</aside>
</section><section>
<h1 id=project-timeline>Project Timeline</h1>
<h4 id=thesis-a>Thesis A</h4>
<ul>
<li>Initial research and research environment setup</li>
<li>Teardown and initial hands-on of Roborock S6</li>
</ul>
<h4 id=thesis-b--c>Thesis B + C</h4>
<ul>
<li>Assessment of product security and privacy</li>
</ul>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br></p>
<h1 id=current-progress>Current Progress</h1>
</section><section>
<h1 id=rolling-research>Rolling Research</h1>
<section data-shortcode-section>
<blockquote>
<p><a href=https://featherbear.cc/UNSW-CSE-Thesis/>featherbear.cc/UNSW-CSE-Thesis</a></p>
</blockquote>
<p><a href=https://featherbear.cc/UNSW-CSE-Thesis/><img src=../../uploads/20211103-screely-1635868857938.png alt></a></p>
</section><section>
<blockquote>
<p><a href=https://featherbear.cc/UNSW-CSE-Thesis/tldr>Summary</a></p>
</blockquote>
<p><a href=https://featherbear.cc/UNSW-CSE-Thesis/tldr><img src=../../uploads/20211103-screely-1635869059154.png alt></a></p>
</section>
</section><section>
<h1 id=preliminary-results>Preliminary Results</h1>
<section data-shortcode-section>
<h3 id=network-setup>Network Setup</h3>
<p><img src=../../uploads/20211027-20211026_210111-highlighted.jpg alt></p>
</section><section>
<h3 id=initial-packet-capture>[Initial] Packet Capture</h3>
<p><img src=../../uploads/20211025-snipaste_2021-10-26_02-04-58.jpg alt></p>
<ul>
<li>No LAN-LAN packets???</li>
<li><label>incomplete test</label> - misconfigured packet capture setup</li>
</ul>
</section><section>
<h3 id=teardown>Teardown</h3>
<p><img src=../../uploads/20211029-20211029_233611.jpg alt></p>
</section><section>
<h3 id=initial-breakdown-and-pinout-where-needed>Initial Breakdown and Pinout (where needed)</h3>
<p><img src=../../uploads/20211029-20211030_021531.jpg alt></p>
<aside class=notes><p>STM32, Allwinner R16 (Quad-core ARMv7 processor), USB Port (custom ADB?)</p>
</aside>
</section><section>
<h3 id=identification-of-the-uart-pins>Identification of the UART pins</h3>
<p><img src=../../uploads/20211029-20211030_021507-uart-highlighted.jpg alt></p>
</section><section>
<h3 id=serial-access>Serial Access</h3>
<ul>
<li>Serial (baud=115200) gives us a shell!</li>
</ul>
<p><img src=../../uploads/20211029-20211030_025959.jpg width=33.5%>
<img src=../../uploads/20211103-serial-comms.gif width=60%></p>
<blockquote>
<p>Need a root password though&mldr;</p>
</blockquote>
</section><section>
<h3 id=u-boot-bootloader>U-Boot Bootloader</h3>
<p><img src=../../uploads/20211103-Snipaste_2021-11-03_03-47-40.jpg alt></p>
<ul>
<li>Able to enter the bootloader shell if <code>s</code> is pressed during init</li>
</ul>
<p><img src=../../uploads/20211029-bootloader-shell.jpg alt></p>
</section><section>
<h3 id=root>Root!</h3>
<p><img src=../../uploads/20211029-snipaste_2021-10-30_03-24-41.jpg alt></p>
<p><img src=../../uploads/20211029-snipaste_2021-10-30_03-26-11.jpg alt></p>
</section>
</section><section>
<h1 id=next-steps>Next Steps</h1>
<ul>
<li>Dump the firmware and begin RE / forensics</li>
<li>Redo (and further investigate) live system analysis
<ul>
<li>i.e. Properly capture <em>all</em> network traffic</li>
</ul>
</li>
</ul>
</section><section>
<h1 id=any-questions>Any Questions?</h1>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br></p>
<hr>
<p>Andrew Wong</p>
<sub>
<p>w: <a href=https://featherbear.cc/UNSW-CSE-Thesis>featherbear.cc/UNSW-CSE-Thesis</a></p>
<p>e: <script>document.write(atob('YW5kcmV3Lmoud29uZ0BzdHVkZW50LnVuc3cuZWR1LmF1'))</script></p>
</sub></section>
</div>
</div>
<script type=text/javascript src=../../reveal-hugo/object-assign.js></script>
<a href=../../reveal-js/css/print/ id=print-location style=display:none></a>
<script type=text/javascript>var printLocationElement=document.getElementById('print-location'),link=document.createElement('link');link.rel='stylesheet',link.type='text/css',link.href=printLocationElement.href+(window.location.search.match(/print-pdf/gi)?'pdf.css':'paper.css'),document.getElementsByTagName('head')[0].appendChild(link)</script>
<script type=application/json id=reveal-hugo-site-params>{"center":false,"custom_theme":"presentations/theme.scss","custom_theme_compile":true,"dependencies":[{"src":"../plugins/capsLockKeymod.js"}],"history":true,"pdf_separate_fragments":true,"slide_number":true,"width":1024}</script>
<script type=application/json id=reveal-hugo-page-params>null</script>
<script src=../../reveal-js/js/reveal.js></script>
<script type=text/javascript>var revealHugoDefaults,revealHugoSiteParams,revealHugoPageParams,options;function camelize(a){return a&&Object.keys(a).forEach(function(b){newK=b.replace(/(\_\w)/g,function(a){return a[1].toUpperCase()}),newK!=b&&(a[newK]=a[b],delete a[b])}),a}revealHugoDefaults={center:!0,controls:!0,history:!0,progress:!0,transition:"slide"},revealHugoSiteParams=JSON.parse(document.getElementById('reveal-hugo-site-params').innerHTML),revealHugoPageParams=JSON.parse(document.getElementById('reveal-hugo-page-params').innerHTML),options=Object.assign({},camelize(revealHugoDefaults),camelize(revealHugoSiteParams),camelize(revealHugoPageParams)),Reveal.initialize(options)</script>
<script type=text/javascript src=../../reveal-js/plugin/markdown/marked.js></script>
<script type=text/javascript src=../../reveal-js/plugin/markdown/markdown.js></script>
<script type=text/javascript src=../../reveal-js/plugin/highlight/highlight.js></script>
<script type=text/javascript src=../../reveal-js/plugin/zoom-js/zoom.js></script>
<script type=text/javascript src=../../reveal-js/plugin/notes/notes.js></script>
<script type=text/javascript>for(let a of document.querySelectorAll(".reveal .slides > section"))a.dataset.transition||(a.dataset.transition="fade-out slide-in")</script>
</body>
</html>