<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<title>Final Thesis Presentation | Andrew Wong</title>
<meta name=description content="Musings of a CSE Thesis">
<meta name=apple-mobile-web-app-capable content="yes">
<meta name=apple-mobile-web-app-status-bar-style content="black-translucent">
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<link rel=stylesheet href=../../reveal-js/css/reset.css>
<link rel=stylesheet href=../../reveal-js/css/reveal.css>
<link rel=stylesheet href=../../_.min.a230c4a7a1567dd6102968d8163a8141477da8488849428e390a8cd00a44c5a7.css id=theme><link rel=stylesheet href=../../highlight-js/default.min.css>
</head>
<body>
<div class=reveal>
<div class=slides>
<section data-noprocess data-shortcode-slide data-background-image=https://featherbear.cc/UNSW-CSE-Thesis/uploads/covers/0T4A9791.JPG data-transition=fade>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br></p>
<h3 id=smart-vacuum-cleaners>&ldquo;Smart&rdquo; Vacuum Cleaners</h3>
<h5 id=an-audit-into-the-security-and-integrity-of-iot-systems>An Audit Into The Security and Integrity of IoT Systems</h5>
<h6 id=andrew-wong--unsw-sydney>Andrew Wong | UNSW Sydney</h6>
</section><section>
<style>img[round]{border-radius:10px}</style>
<h2 id=todays-agenda>Today&rsquo;s Agenda</h2>
<ul>
<li><label>Topic Recap</label>
<ul>
<li>The world of IOT devices</li>
<li>Thesis statement</li>
</ul>
</li>
<li><label>Where we left off</label>
<ul>
<li>Previous results and findings</li>
</ul>
</li>
<li><label>New progress</label></li>
<li><label>Discussion</label></li>
<li><label>Conclusion</label></li>
</ul>
</section><section>
<style>.marquee-parent{position:relative;width:100vw;max-width:100%;height:200px;overflow-x:hidden;border-radius:10px}.marquee-child{position:absolute;white-space:nowrap;will-change:transform;max-width:unset!important;max-height:100%!important;animation:marquee 360s linear infinite}.marquee-child:hover{animation-play-state:paused}@keyframes marquee{from{transform:translateX(0)}to{transform:translateX(-87.5%)}}</style>
<p><br></p>
<div class=marquee-parent><img src=../../uploads/20211115-lightbulbs-marquee.png class=marquee-child></div>
</br>
<section data-shortcode-section>
<p><em>&mldr;so there are a lot of IOT devices and IOT brands out there&mldr;</em></p>
<aside class=notes><p>Smart watches, smart washing machines, smart flip-flop shoes&mldr;</p>
</aside>
</section><section>
<p>üïµÔ∏è‚Äç‚ôÇÔ∏è Are competing products looking suspiciously similar to you?<br>
Most are <u>white-labelled</u> products, the biggest ecosystem vendor being <span style=display:inline-table;vertical-align:middle><img src=../../uploads/tuya_logo.png height=40px alt=Tuya></span></p>
<p><label>Pros</label></p>
<p>üë®‚Äçüíª Use someone else&rsquo;s code<br>
üíπ Fast profit turnaround</p>
<p><label>Cons</label></p>
<p>‚ö†Ô∏è Use someone else&rsquo;s code<br>
üê±‚Äçüíª Potentially security vulnerabilities</p>
<aside class=notes><p>FYI not here to tell you whether or not IOT devices are good or not&mldr; that&rsquo;s for you to judge. My research is on whether these big players have been doing their part (as providers) to keep us safe</p>
</aside>
</section><section>
<p>IOT ecosystems often have a centralised system to manage their fleet <span style=font-size:18px> (devices)</span>.</p>
<p><label>Pros</label></p>
<p>A centralised management is <u><i>so</i></u> much simpler/easier/faster/cheaper/&lsquo;better&rsquo; than a decentralised one.</p>
<p><label>Cons</label></p>
<p>‚ö†Ô∏è Device functionality dependent on system availability<br>
‚ö†Ô∏è Little transparency about what/where/when/why data is transmitted</p>
</section>
</section><section>
<h1 id=statement>Statement</h1>
<section data-shortcode-section>
<blockquote>
</blockquote>
<div>
How have manufacturers of IoT / smart home devices addressed the increasing concerns of digital privacy and product security?
<div style=text-align:right;font-size:20px>(Specifically Roborock / Xiaomi / Tuya)</span>
</div>
<blockquote>
</blockquote>
<p><br>
<br></p>
<ul>
<li>Digital Privacy
<ul>
<li>Investigate the nature of network data</li>
<li>i.e. content, frequency, destination, usage</li>
</ul>
</li>
<li>Product Security
<ul>
<li>Investigate security vulnerabilities</li>
<li>Assess the effectiveness of security fortifications</li>
</ul>
</li>
</ul>
</section><section>
<div style=display:flex;flex-direction:row>
<div>
Our device in scope: <label>Roborock S6</label> (2019)
<p>A smart vacuum cleaner, with integrations to both <span style=display:inline-table;vertical-align:middle><img src=../../uploads/tuya_logo.png height=40px alt=Tuya></span> and <span style=display:inline-table;vertical-align:middle><img src=../../uploads/xiaomi_smartlife_logo.webp height=40px alt="Mijia (Xiaomi)"></span> (depending on model)</p>
</div>
<img src=../../uploads/20211103-s6-pure-banner.webp width=500px>
</div>
<blockquote>
<p>It works pretty (very) well, according to reviews.<br>
But is it safe to connect to your home?</p>
</blockquote>
</section>
</section><section>
<p>Talk about thesis A
talk about thesis b
Talk about thesis c</p>
</section><section>
<section data-shortcode-section>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br></p>
<h1 id=thesis-b--results>Thesis B | Results</h1>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<p>Thesis B - Inspection of system (privileged processes)</p>
<iframe style="border:2px solid #fff;border-radius:10px;pointer-events:none" width=1280 height=720 src=../seminar-b/?noControls#/7/2></iframe>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<p>Thesis B - Recovery partition manipulation (see <a href="https://www.youtube.com/watch?v=eABmzUfZ22A">proof of concept</a>)</p>
<iframe style="border:2px solid #fff;border-radius:10px;pointer-events:none" width=1280 height=720 src=../seminar-b/?noControls#/12/3></iframe>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<p>Thesis B - Capture of device traffic (port-mirroring)</p>
<iframe style="border:2px solid #fff;border-radius:10px;pointer-events:none" width=1280 height=720 src=../seminar-b/?noControls#/6></iframe>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<p>Thesis B - Inspection of system services (<code>netstat</code>, <code>iptables</code>, <code>ip6tables</code>)</p>
<iframe style="border:2px solid #fff;border-radius:10px;pointer-events:none" width=1280 height=720 src=../seminar-b/?noControls#/7/3></iframe>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<p>Thesis B - Remote access persistence (see <a href="https://www.youtube.com/watch?v=om2yzYHU1A0">proof of concept</a>)</p>
<iframe style="border:2px solid #fff;border-radius:10px;pointer-events:none" width=1280 height=720 src=../seminar-b/?noControls#/8></iframe>
</section>
</section><section>
<section data-shortcode-section>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br></p>
<h1 id=thesis-b--observations>Thesis B | Observations</h1>
</section><section>
<p>Thesis B - Investigating <code>tcpdump</code></p>
<iframe style="border:2px solid #fff;border-radius:10px;pointer-events:none" width=1280 height=720 src=../seminar-b/?noControls#/11/4></iframe>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<p>Thesis B - Investigating <code>rrlogd</code></p>
<iframe style="border:2px solid #fff;border-radius:10px;pointer-events:none" width=1280 height=720 src=../seminar-b/?noControls#/11/6></iframe>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<p>Thesis B - Investigating <code>adbd</code></p>
<iframe style="border:2px solid #fff;border-radius:10px;pointer-events:none" width=1280 height=720 src=../seminar-b/?noControls#/11/8></iframe>
</section>
</section><section>
<section data-shortcode-section>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br></p>
<h1 id=thesis-b--future-challenges>Thesis B | Future Challenges</h1>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<p>Thesis B - Comparing files</p>
<iframe style="border:2px solid #fff;border-radius:10px;pointer-events:none" width=1280 height=720 src=../seminar-b/?noControls#/13/4></iframe>
</section>
<section data-noprocess data-shortcode-slide data-transition=fade>
<p>Thesis B - Hooking into pre-encryption / post-decryption routines</p>
<iframe style="border:2px solid #fff;border-radius:10px;pointer-events:none" width=1280 height=720 src=../seminar-b/?noControls#/13></iframe>
</section>
</section><section>
<h4 id=labelthesis-b-completionlabel><label>Thesis B Completion</label></h4>
<ul>
<li>Analysis of firmware binaries to identify vulnerabilities
<ul>
<li>Still in progress</li>
</ul>
</li>
<li>Search for unsecured secrets, logs, configurations
<ul>
<li>Completed (excluding encrypted <code>rrlog</code> files)</li>
</ul>
</li>
</ul>
<h4 id=labelrevised-thesis-c-planlabel><label>Revised Thesis C Plan</label></h4>
<ul>
<li>WAN - security, PII</li>
<li>LAN - traffic? (tcpdump)</li>
<li>Firmware upgrade</li>
<li>Update to a newer firmware version and look at changes</li>
<li>Check what files gets cleared during a format</li>
<li>Binary assessment</li>
<li>Verify IPv6 SSH access</li>
</ul>
<h1 id=the-ipv6-world>The IPv6 World</h1>
</section><section>
<h2 id=incoming-timeline>Incoming Timeline</h2>
<ul>
<li><label>22T2 W1</label> - IPv6 SSH verification, continue binary assessment</li>
<li><label>22T2 W2</label> - WAN traffic analysis
<ul>
<li>Look at network behaviour</li>
<li>Try view WAN data pre-encryption / post-decryption</li>
</ul>
</li>
<li><label>22T2 W4</label> - Update to latest version (and hope we don&rsquo;t get locked out)
<ul>
<li>Do another vacuum clean, reimage, compare binaries</li>
</ul>
</li>
<li><label>22T2 W5</label> - Factory reset device, check for remnant files</li>
<li><label>22T2 W8</label> - Demo submission</li>
<li><label>22T2 W11</label> - Report submission</li>
</ul>
<h1 id=lets-talk-threats>Let&rsquo;s Talk Threats</h1>
<blockquote>
<p>Talk about threat models</p>
</blockquote>
</section><section>
<p>What files?</p>
<ul>
<li>compare against stock</li>
<li>lots of hash matches</li>
</ul>
<p>threat models</p>
<p>work done in thesis c</p>
<p>hooking into code..</p>
<p>Network analysis</p>
<ul>
<li>MQTT at [ms|m2].tuyaeu.com</li>
<li>Control at a2.tuyaeu.com</li>
<li>Used to use Mi IO for <code>gslb</code>
<ul>
<li>Likely stands for &ldquo;Global Server Load Balancing&rdquo;</li>
</ul>
</li>
<li>Ubuntu artifacts (SSDP)</li>
<li>DHCP request</li>
<li>3am and 3pm activity</li>
<li>Connections to America, Germany, China</li>
<li>UNSW Elec - MUD - they could do this to heighten security
<ul>
<li>note - doesn&rsquo;t prevent them from being malicious from within their own C2 server, but will mitigate modified devices</li>
</ul>
</li>
</ul>
<p>adb &mdash; touched though didn&rsquo;t crack</p>
<p>rrlogd can trigger wlanmgr to do a tcpdump (makes sense kinda) - MSG_LOG_DEBUG_ENABLE - MSG_LOG_DEBUG_UPLOAD_DATA
wlanmgr can also call tcpdump during debug</p>
<p>no ipv6</p>
<p>photorec no because flashing</p>
<p>Compare against stock OS</p>
<p>&ndash; upgrade</p>
<ul>
<li>ipv6 blocked!
<ul>
<li>also no longer pings fds AAAA</li>
</ul>
</li>
<li>no longer use default Ubuntu</li>
<li>no apt, dpkg</li>
<li>dropbear (SSH)
<ul>
<li>also not started by default</li>
<li>very old, only uses diffie for key exch</li>
</ul>
</li>
<li>rr_login - root only
<ul>
<li>used to be getty</li>
<li>new way to get shell</li>
</ul>
</li>
<li>applications check /mnt/default/shadow (non-existent)
<ul>
<li>dropbear</li>
<li>rr_login</li>
</ul>
</li>
<li>several processes re-run iptables block
<ul>
<li>rrlogd, watchdoge</li>
</ul>
</li>
<li>busybox</li>
<li>persistence
<ul>
<li>/mnt/data</li>
<li>/mnt/reserve</li>
</ul>
</li>
<li>malware persistence idea</li>
<li>need new way to transfer files / cross-compile</li>
</ul>
<p>reset persistence</p>
<ul>
<li>/mnt/reserve kept</li>
<li>patch the recovery partition mmcblk0p7</li>
</ul>
<p>talk about miIO vuln
miIO ota - patched</p>
<p>Response to disclosures
tuya and roborock only have one disclosure listed on their site?
Hard to find</p>
<p>Takeaway
Summary (answer main point)</p>
<p>tldr
Who
What
When
Why
Where
How</p>
</section><section>
<p>Address the statement</p>
</section><section>
<h1 id=thesis-in-a-year>Thesis in a Year</h1>
<p><img src=../../uploads/screely-1658645824986.png alt></p>
</section><section>
<h1 id=thank-you>Thank You</h1>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br></p>
<hr>
<p>Andrew Wong</p>
<sub>
<p>w: <a href=https://featherbear.cc/UNSW-CSE-Thesis>featherbear.cc/UNSW-CSE-Thesis</a></p>
<p>e: <script>document.write(atob('YW5kcmV3Lmoud29uZ0BzdHVkZW50LnVuc3cuZWR1LmF1'))</script></p>
</sub></section>
</div>
</div>
<script type=text/javascript src=../../reveal-hugo/object-assign.js></script>
<a href=../../reveal-js/css/print/ id=print-location style=display:none></a>
<script type=text/javascript>var printLocationElement=document.getElementById('print-location'),link=document.createElement('link');link.rel='stylesheet',link.type='text/css',link.href=printLocationElement.href+(window.location.search.match(/print-pdf/gi)?'pdf.css':'paper.css'),document.getElementsByTagName('head')[0].appendChild(link)</script>
<script type=application/json id=reveal-hugo-site-params>{"center":false,"custom_theme":"presentations/theme.scss","custom_theme_compile":true,"dependencies":[{"src":"../plugins/capsLockKeymod.js"}],"history":true,"pdf_separate_fragments":true,"slide_number":true,"width":1024}</script>
<script type=application/json id=reveal-hugo-page-params>null</script>
<script src=../../reveal-js/js/reveal.js></script>
<script type=text/javascript>var revealHugoDefaults,revealHugoSiteParams,revealHugoPageParams,options;function camelize(a){return a&&Object.keys(a).forEach(function(b){newK=b.replace(/(\_\w)/g,function(a){return a[1].toUpperCase()}),newK!=b&&(a[newK]=a[b],delete a[b])}),a}revealHugoDefaults={center:!0,controls:!0,history:!0,progress:!0,transition:"slide"},revealHugoSiteParams=JSON.parse(document.getElementById('reveal-hugo-site-params').innerHTML),revealHugoPageParams=JSON.parse(document.getElementById('reveal-hugo-page-params').innerHTML),options=Object.assign({},camelize(revealHugoDefaults),camelize(revealHugoSiteParams),camelize(revealHugoPageParams)),Reveal.initialize(options)</script>
<script type=text/javascript src=../../reveal-js/plugin/markdown/marked.js></script>
<script type=text/javascript src=../../reveal-js/plugin/markdown/markdown.js></script>
<script type=text/javascript src=../../reveal-js/plugin/highlight/highlight.js></script>
<script type=text/javascript src=../../reveal-js/plugin/zoom-js/zoom.js></script>
<script type=text/javascript src=../../reveal-js/plugin/notes/notes.js></script>
<script type=text/javascript>for(let a of document.querySelectorAll(".reveal .slides > section"))a.dataset.transition||(a.dataset.transition="fade-out slide-in");document.querySelectorAll('p img').forEach(b=>{if(b.alt!='center')return;let a=b;while(a.tagName!='P')a=a.parentNode;a.style.textAlign='center'})</script>
</body>
</html>