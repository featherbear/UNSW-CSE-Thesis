<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<title>Seminar B | Andrew Wong</title>
<meta name=description content="Musings of a CSE Thesis">
<meta name=apple-mobile-web-app-capable content="yes">
<meta name=apple-mobile-web-app-status-bar-style content="black-translucent">
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<link rel=stylesheet href=../../reveal-js/css/reset.css>
<link rel=stylesheet href=../../reveal-js/css/reveal.css>
<link rel=stylesheet href=../../_.min.a230c4a7a1567dd6102968d8163a8141477da8488849428e390a8cd00a44c5a7.css id=theme><link rel=stylesheet href=../../highlight-js/default.min.css>
</head>
<body>
<div class=reveal>
<div class=slides>
<section data-noprocess data-shortcode-slide data-background-image=https://featherbear.cc/UNSW-CSE-Thesis/uploads/covers/0T4A9791.JPG data-transition=fade>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br></p>
<h3 id=smart-vacuum-cleaners>&ldquo;Smart&rdquo; Vacuum Cleaners</h3>
<h5 id=an-audit-into-the-security-and-integrity-of-iot-systems>An Audit Into The Security and Integrity of IoT Systems</h5>
<h6 id=andrew-wong--unsw-sydney>Andrew Wong | UNSW Sydney</h6>
</section><section>
<style>img[round]{border-radius:10px}</style>
<h1 id=todays-agenda>Today&rsquo;s Agenda</h1>
<ul>
<li>Thesis B plan</li>
<li>Thesis B review</li>
<li>Thesis B retrospective</li>
<li>Thesis C revised plan</li>
</ul>
</section><section>
<h1 id=statement>Statement</h1>
<blockquote>
</blockquote>
<p>How have manufacturers of IoT / smart home devices addressed the increasing concerns of digital privacy and product security?</p>
<blockquote>
</blockquote>
<span class=fragment><p>¬†<br>
¬†</p>
<ul>
<li>Digital Privacy - Investigate the nature of network data (i.e. content, frequency, destination) and how the data is used.</li>
<li>Product Security - Investigate potential security vulnerabilities and assess the effectiveness of current security fortifications.</li>
</ul>
</span>
</section><section>
<h1 id=original-project-timeline>Original Project Timeline</h1>
<h4 id=labelthesis-b---binary-assessmentlabel><label>Thesis B - Binary Assessment</label></h4>
<ul>
<li>Disassembly and analysis of firmware binaries to identify vulnerabilities
<ul>
<li>inc. ADB binary functionality</li>
</ul>
</li>
<li>Search for unsecured secrets, logs, configurations</li>
</ul>
<h4 id=labelthesis-c---connectivity-assessmentlabel><label>Thesis C - Connectivity Assessment</label></h4>
<ul>
<li>Inspection of outbound internet traffic - security, PII, etc</li>
<li>Inspection of local network traffic</li>
<li>Inspection of interaction with nearby devices</li>
<li>Protocol analysis</li>
</ul>
</section>
<section data-noprocess data-shortcode-slide data-background-image=https://featherbear.cc/UNSW-CSE-Thesis/uploads/20211030_040050.jpg data-transition=fade>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br></p>
<h3 id=thesis-b-in-review>Thesis B in Review</h3>
</section><section>
<h1 id=more-logging>More logging</h1>
<p>Previously packet captures only logged WAN traffic&mldr;</p>
<section data-shortcode-section>
<ul>
<li>Now port mirroring from a switch (<a href=https://www.tp-link.com/au/business-networking/easy-smart-switch/tl-sg105e/>TP-Link TL-SG105E</a>)</li>
<li>Now getting all LAN data too! (port mirrored from AP)</li>
</ul>
<p><img src=../../uploads/Snipaste_2022-05-05_01-31-27.jpg alt></p>
</section><section>
<div style=display:flex;flex-direction:row>
<div><img round src=../../uploads/Snipaste_2022-05-05_01-32-07.jpg></div>
<div><img round src=../../uploads/Snipaste_2022-05-05_01-31-55.jpg></div>
</div>
<ul>
<li>The switch doesn&rsquo;t have true port mirroring - also seeing sink traffic</li>
<li>Disabled IPv4 and (attempt to disable) IPv6 on the network adapter</li>
<li>Can filter out irrelevant packets later</li>
</ul>
</section><section>
<blockquote>
<p>Will later use dumps to check frequency and access</p>
</blockquote>
<div style=text-align:center>
<img round src=../../uploads/Snipaste_2022-05-05_17-23-11.jpg width=65%>
</div>
</section>
</section><section>
<h1 id=speaking-of-packets>Speaking of packets&mldr;</h1>
<blockquote>
<p>üö© WiFi credentials in plain text during setup</p>
</blockquote>
<div style=text-align:center>
<img round src=../../uploads/Snipaste_2022-05-02_01-14-22.jpg width=80%>
</div>
<ul>
<li>Minor issue, only exploitable during time of setup</li>
</ul>
</section><section>
<h1 id=fingerprinting>Fingerprinting</h1>
<section data-shortcode-section>
<p><label>System</label></p>
<pre><code>[ 0.340]U-Boot 2011.09-rc1-dirty (Mar 25 2020 - 20:45:43) Allwinner Technology
[ 0.000000] Linux version 3.4.39 (rockrobo@apimg) (gcc version 4.8.4 (Ubuntu/Linaro 4.8.4-2ubuntu1~14.04.1) ) #1 SMP PREEMPT Wed Mar 25 20:47:59 CST 2020
[ 0.000000] CPU: ARMv7 Processor [410fc075] revision 5 (ARMv7), cr=10c5387d
[ 0.000000] Machine: sun8i
...
</code></pre>
<p>CPU: Allwinner R16 (ARM Cortex-A7) - ARMv7l / armhf<br>
ACU: STM32F103VCT6 (ARM Cortex-M3)<br>
Roborock Firmware version: 3.5.4_1558<br>
Operating system: Ubuntu 14.04.3 LTS</p>
</section><section>
<p><label>Users</label></p>
<div style=display:flex;flex-direction:row>
<div><img round src=../../uploads/Snipaste_2022-05-01_20-00-22.jpg></div>
<div><img round src=../../uploads/Snipaste_2022-05-01_20-00-48.jpg></div>
</div>
<blockquote>
<p>No additional users</p>
</blockquote>
<blockquote>
</blockquote>
<pre><code>root@rockrobo:~# ls /home
ruby
</code></pre>
<p><code>/home/ruby</code> exists but no user <code>ruby</code>, though exists in <code>/etc/passwd~</code></p>
</section><section>
<p><label>Processes</label></p>
<p>üö© Everything is running as root</p>
<div style=text-align:center>
<img src=../../uploads/Snipaste_2022-05-01_19-33-46.jpg width=80%>
</div>
</section><section>
<p><label>Ports</label></p>
<pre><code class=language-bash>root@rockrobo:~# netstat -nltp
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address      State       PID/Program name
tcp        0      0 127.0.0.1:54322         0.0.0.0:*            LISTEN      991/miio_client 
tcp        0      0 127.0.0.1:54323         0.0.0.0:*            LISTEN      991/miio_client 
tcp        0      0 0.0.0.0:22              0.0.0.0:*            LISTEN      1644/sshd       
tcp        0      0 127.0.0.1:55551         0.0.0.0:*            LISTEN      998/rriot_tuya  
tcp        0      0 0.0.0.0:6668            0.0.0.0:*            LISTEN      998/rriot_tuya  
tcp6       0      0 :::22                   :::*                 LISTEN      1644/sshd       
</code></pre>
<p>üö© <code>tcp/22</code> and <code>tcp/6668</code> are exposed</p>
</section><section>
<p><label>Firewall</label></p>
<p>ü§∑‚Äç‚ôÇÔ∏è At least port 22 is blocked by <code>iptables</code></p>
<pre><code>root@rockrobo:~# iptables -L
Chain INPUT (policy ACCEPT)
target     prot opt source           destination         
DROP       udp  --  anywhere         anywhere           udp dpt:6665
DROP       tcp  --  anywhere         anywhere           tcp dpt:6665
DROP       tcp  --  anywhere         anywhere           tcp dpt:ssh

Chain FORWARD (policy ACCEPT)
target     prot opt source           destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source           destination      
</code></pre>
<ul>
<li>What runs on port <code>6665</code>
<ul>
<li><code>player</code></li>
<li>What about file-based IPC?</li>
</ul>
</li>
</ul>
</section><section>
<pre><code>root@rockrobo:~# ip6tables -L
Chain INPUT (policy ACCEPT)
target     prot opt source           destination         

Chain FORWARD (policy ACCEPT)
target     prot opt source           destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source           destination
</code></pre>
<p>üö© &mldr; except IPv6 isn&rsquo;t..</p>
<blockquote>
<p>Future work: Test IPv6 lease</p>
</blockquote>
</section><section>
<p><label>Other small tests</label></p>
<ul>
<li>Can I ping the internet / make outbound connections?
<ul>
<li>Yes</li>
</ul>
</li>
<li>Can I run my own software
<ul>
<li>Yes (<code>armhf</code> architecture)</li>
</ul>
</li>
</ul>
</section>
</section><section>
<h1 id=going-wireless---establishing-ssh>Going wireless - establishing SSH</h1>
<div style=display:flex;flex-direction:row;align-items:center>
<div style=flex:1>
<img round src=iptables.png>
<img round src=../../uploads/Snipaste_2022-05-05_05-06-28.jpg>
</div>
<div style=flex:1>
<ul>
<li>Remove iptables rule to gain access
<ul>
<li>(and so could an attacker)</li>
</ul>
</li>
<li>Can I add persistent access?
<ul>
<li>Yes, modify <code>rrwatchdoge.conf</code></li>
</ul>
</li>
<li>Can also add remote access
<ul>
<li>üëà e.g. ZeroTier</li>
</ul>
</li>
</ul>
<p><img src=../../uploads/Snipaste_2022-05-02_01-42-29.jpg alt="zerotier persistence"></p>
</div>
</div>
</section><section>
<section data-shortcode-section>
<h1 id=trivial-power-analysis>Trivial Power Analysis</h1>
<blockquote>
<p>Batteries don&rsquo;t last forever!</p>
</blockquote>
<p><img src=../../uploads/20220501_051651.jpg alt></p>
</section><section>
<blockquote>
<p>Test: What if I unplug the battery?</p>
</blockquote>
<ul>
<li>No change in output during boot</li>
<li>But device will turn off after around 20 seconds</li>
</ul>
<pre><code>Ubuntu 14.04.3 LTS rockrobo ttyS0

rockrobo login:                                                 #### Usual login prompt
wait-for-state stop/waiting
haveged: haveged Stopping due to signal 15                      #### Shutdown SIGTERM 

 * Stopping rsync daemon rsync                                           [ OK ] 
 * (not running)
 * Asking all remaining processes to terminate...                        [ OK ] 
 * All processes ended within 1 seconds...                               [ OK ] 
umount: /tmp: device is busy.
        (In some cases useful info about processes that use
         the device is found by lsof(8) or fuser(1))
 * Unmounting temporary filesystems...                                   [fail] 
 * Deactivating swap...                                                  [ OK ] 
 * Unmounting local filesystems...                                       [ OK ] 
 * Will now halt
[   26.948171] [MCU_UART] sent ap poweroff event to mcu         #### Device turns off
</code></pre>
<p>See <a href=https://featherbear.cc/UNSW-CSE-Thesis/posts/power/serial-dump-during-2-wire-power/>2-wire log</a>, <a href=https://featherbear.cc/UNSW-CSE-Thesis/posts/power/serial-dump-during-4-wire-power/>4-wire log</a></p>
</section>
</section><section>
<section data-shortcode-section>
<h1 id=file-system-imaging>File System Imaging</h1>
<p>The eMMC only has 4GB of storage, so we can&rsquo;t (also shouldn&rsquo;t) image the flash onto itself&mldr; but we can image it remotely!</p>
<pre><code class=language-bash>IP=10.10.10.8
for partition in `ssh root@$IP &quot;ls /dev/mmcblk0?* -1&quot;`
do
    ssh root@$IP &quot;sudo dd if=$partition bs=1M&quot; | dd of=$(basename $partition).img
done
</code></pre>
<div style=text-align:center>
<img src=../../uploads/20220430-disk_imaging.jpg>
</div>
</section><section>
<h1 id=file-system-structure>File System Structure</h1>
<table>
<thead>
<tr>
<th style=text-align:left>partition</th>
<th style=text-align:left>label</th>
<th style=text-align:left>size</th>
<th style=text-align:left>description</th>
</tr>
</thead>
<tbody>
<tr>
<td style=text-align:left>mmcblk0p1</td>
<td style=text-align:left>UDISK</td>
<td style=text-align:left>1.5 GB</td>
<td style=text-align:left>user data</td>
</tr>
<tr>
<td style=text-align:left>mmcblk0p2</td>
<td style=text-align:left>boot-res</td>
<td style=text-align:left>8 MB</td>
<td style=text-align:left>bootloader stuff</td>
</tr>
<tr>
<td style=text-align:left>mmcblk0p5</td>
<td style=text-align:left>env</td>
<td style=text-align:left>16 MB</td>
<td style=text-align:left></td>
</tr>
<tr>
<td style=text-align:left>mmcblk0p6</td>
<td style=text-align:left>app (RO)</td>
<td style=text-align:left>64 MB</td>
<td style=text-align:left>device data</td>
</tr>
<tr>
<td style=text-align:left>mmcblk0p7</td>
<td style=text-align:left>recovery</td>
<td style=text-align:left>512 MB</td>
<td style=text-align:left>stock firmware</td>
</tr>
<tr>
<td style=text-align:left>mmcblk0p8</td>
<td style=text-align:left>system_a</td>
<td style=text-align:left>512 MB</td>
<td style=text-align:left>Main OS (boot)</td>
</tr>
<tr>
<td style=text-align:left>mmcblk0p9</td>
<td style=text-align:left>system_b</td>
<td style=text-align:left>512 MB</td>
<td style=text-align:left>Backup OS</td>
</tr>
<tr>
<td style=text-align:left>mmcblk0p10</td>
<td style=text-align:left>Download</td>
<td style=text-align:left>528 MB</td>
<td style=text-align:left>Update temp</td>
</tr>
<tr>
<td style=text-align:left>mmcblk0p11</td>
<td style=text-align:left>reserve</td>
<td style=text-align:left>16 MB</td>
<td style=text-align:left>blackbox???</td>
</tr>
</tbody>
</table>
</section><section>
<h1 id=recovery-reset>Recovery Reset</h1>
<p>Recovery supposedly resets <code>system_a</code>, <code>system_b</code>, <code>UDISK</code> and <code>Download</code></p>
<div style=text-align:center>
<img src=../../uploads/20220501-recovery.png width=70%>
</div>
<ul>
<li>What about the other partitions?</li>
<li>Can we install software in the <code>recovery</code> partition? <label>A: Yes</label> üö©</li>
</ul>
</section><section>
<div style=display:flex;flex-direction:row;align-items:center>
<img src=../../uploads/Snipaste_2022-05-01_05-53-51.jpg width=65% style=flex:1>
<div style=flex:1>
<blockquote>
<p>28,189 files&mldr;</p>
</blockquote>
<blockquote>
<p>Well there&rsquo;s for sure a lot of files to look at&mldr;</p>
</blockquote>
</div>
</div>
</section><section>
<h1 id=i-did-a-thing---commentreehttpsgithubcomfeatherbearcommentree>I did a thing - <a href=https://github.com/featherbear/commentree>Commentree</a></h1>
<blockquote>
<p>Plain-text annotation / commentary tool</p>
</blockquote>
<p><img src=commentree.png alt> </p>
</section>
</section><section>
<h1 id=some-interesting-files>(some) Interesting Files</h1>
<section data-shortcode-section>
<h2 id=the-search>The Search</h2>
<ul>
<li>Looked for any passwords, secrets, keys, IDs, function calls, logs, &mldr;</li>
<li>Find changed files (*)</li>
<li>See where they are used</li>
<li>See how they are used</li>
<li>Anything of general interest</li>
</ul>
</section><section>
<ul>
<li>mmcblk0p1
<ul>
<li>miio/device.token</li>
<li>miio/device.uid</li>
<li>rockrobo/</li>
<li>rockrobo/rrlog/ (logs are encrypted!)</li>
</ul>
</li>
<li>mmcblk0p8/opt/rockrobo
<ul>
<li>Binaries</li>
<li>scripts/pipes.sh</li>
<li>rrlog/misc.sh</li>
</ul>
</li>
<li>mmcblk0p11/endpoint.bin - AWS address + key?</li>
</ul>
</section><section>
<blockquote>
<p><code>mmcblk0p8/opt/rockrobo/rrlog/misc.sh</code></p>
</blockquote>
<pre><code class=language-bash>...

#echo &quot;=======device.conf==========&quot; &gt;&gt; /dev/shm/misc.log
#cat /mnt/default/device.conf &gt;&gt; /dev/shm/misc.log

...
</code></pre>
<blockquote>
<p><code>mmcblk0p6/device.conf</code></p>
</blockquote>
<pre><code class=language-bash>did=DDDDDDDDD                    # (9 digits)
key=XXXXXXXXXXXXXXXX             # (16 alpha-num, case-sensitive)
mac=64:90:C1:1D:24:C4
vendor=roborock
model=roborock.vacuum.s6
</code></pre>
</section><section>
<blockquote>
<p>Calls for <code>system</code></p>
</blockquote>
<p><img src=../../uploads/Snipaste_2022-05-09_00-34-19.jpg alt></p>
</section><section>
<blockquote>
<p><code>/var/log/apt/history.log</code></p>
</blockquote>
<p>Installed packages that are not part of the base system</p>
<pre><code>Start-Date: 2016-01-25  11:18:05
Commandline: /usr/bin/apt-get install rsync
Install: rsync:armhf (3.1.0-2ubuntu0.2)
End-Date: 2016-01-25  11:18:11

Start-Date: 2016-04-05  12:30:59
Commandline: /usr/bin/apt-get install ccrypt
Install: ccrypt:armhf (1.10-4)
End-Date: 2016-04-05  12:31:01

Start-Date: 2016-04-25  09:58:29
Commandline: /usr/bin/apt-get install tcpdump
Install: tcpdump:armhf (4.5.1-2ubuntu1.2), libpcap0.8:armhf (1.5.3-2, automatic)
End-Date: 2016-04-25  09:58:33
</code></pre>
<ul>
<li>Why does a vacuum cleaner need <code>rsync</code> or <code>tcpdump</code>?</li>
<li>No usage calls found yet</li>
</ul>
</section><section>
<blockquote>
<p><code>mmcblk0p7/usr/sbin/tcpdump</code></p>
</blockquote>
<ul>
<li>External but unmodified binary</li>
<li>Only hub traffic visible (wireless)</li>
<li>(not really that interesting)</li>
</ul>
<p><img src=../../uploads/Snipaste_2022-05-01_19-37-08.jpg alt></p>
</section><section>
<blockquote>
<p><code>mmcblk0p8/opt/rockrobo/rrlog/rrlogd</code></p>
</blockquote>
<p>‚úÖ Logs are encrypted at rest (after being packed)<br>
‚úÖ Originally used to be a symmetric key, now using a public key<br>
üòï Logging program has the functionality to unblock port 22?</p>
<div style=display:flex;flex-direction:row>
<div><img src=../../uploads/Snipaste_2022-05-02_02-37-10.jpg></div>
<div><img src=../../uploads/Snipaste_2022-05-02_02-46-06.jpg></div>
</div>
<pre><code>iptables -I INPUT -j ACCEPT -p tcp --dport 22
</code></pre>
</section><section>
<blockquote>
<p><code>mmcblk0p6/vinda</code></p>
</blockquote>
<p>Previously&mldr; XOR this file to get the <code>root</code> password</p>
<p><label>File References</label></p>
<p><img src=../../uploads/Snipaste_2022-05-09_00-56-25.jpg alt></p>
</section><section>
<blockquote>
<p><code>mmcblk0p7/usr/bin/adbd</code></p>
</blockquote>
<ul>
<li>Custom ADB binary</li>
<li>Had a brief look <a href=https://featherbear.cc/UNSW-CSE-Thesis/posts/mmcblk0p7-usr-bin-adbd/>(more)</a></li>
</ul>
<pre><code>locksec_init_key: can not find the prefix str from adb conf file, use default
locksec_init_key: can not find the suffix str from adb conf file, use default
locksec_init_serial: adb read 465 bytes from /proc/cpuinfo
locksec_init_key: locksec_init_key, rockrobo%()+-[]_8a80ab8936d76c118000:;&lt;=&gt;?@{}rubydevicemodel
locksec_apply_key: locksec_apply_key, erI09cyW%()+-[]_8a80ab8936d76c118000:;&lt;=&gt;?@{}CzD2xuMNlwabTK7
locksec_apply_passwd: adb source str: erI09cyW%()+-[]_8a80ab8936d76c118000:;&lt;=&gt;?@{}CzD2xuMNlwabTK7
locksec_apply_passwd: locksec_apply_passwd, passwd: 0y[ad8@w
</code></pre>
<p><label>Related files</label></p>
<ul>
<li>mmcblk0p6/vinda</li>
<li>mmcblk0p6/adb.conf</li>
<li>mmcblk0p8/var/log/upstart/adbd.log</li>
</ul>
</section><section>
<h2 id=future-the-other-programs>Future: the other programs</h2>
<ul>
<li>cleaner</li>
<li>miio</li>
<li>rockrobo</li>
<li>rrlog</li>
<li>rriot</li>
</ul>
</section>
</section><section>
<h1 id=issues-thoughts--discussions>Issues, thoughts & discussions</h1>
<p><small>How have manufacturers of IoT / smart home devices addressed the increasing concerns of digital privacy and product security?</small></p>
<aside class=notes>We&rsquo;re not answering the question just yet, just some thoughts</aside>
<section data-shortcode-section>
<blockquote>
<p>üö© Wireless credentials are stored in plain text</p>
</blockquote>
<ul>
<li>Anyone with <label>physical</label> access to the machine can gain wireless credentials</li>
<li>However, takes a lot of effort to open up the device</li>
<li>Why? <code>wpa_supplicant</code> is part of the underlying Linux framework</li>
</ul>
</section><section>
<blockquote>
<p>‚ö†Ô∏è SSH server exposed on <code>tcp/22</code></p>
</blockquote>
<ul>
<li>Why does this server exist?</li>
<li>When / where is it used?
<ul>
<li>Allow rule inside the <code>rrlogd</code> binary</li>
</ul>
</li>
<li>Roborock has made an attempt to protect their product with <code>iptables</code></li>
<li>But did not fully product their product against access via IPv6</li>
</ul>
</section><section>
<blockquote>
<p>üö© Processes are running as <code>root</code></p>
</blockquote>
<ul>
<li>Any vulnerability in any of the programs can result in elevated access
<ul>
<li>Dropping of iptables restrictions</li>
<li>Persistence planting</li>
<li>System takeover</li>
</ul>
</li>
<li>Should run as a de-privileged user</li>
<li>Why? Compatibility, perhaps ease of development
<ul>
<li>i.e. <code>udev</code> rules</li>
</ul>
</li>
</ul>
</section><section>
<blockquote>
<p>üö© Recovery partition is modifiable</p>
</blockquote>
<ul>
<li>Can be modified to contain malicious software that persists a factory reset</li>
<li>Mountable - <code>mount /dev/mmcblk0p7 ...</code></li>
<li>Why? Allows easy updates of the &lsquo;factory image&rsquo;</li>
<li>But the partition could somehow be encrypted</li>
</ul>
</section><section>
<p><label>A note on hardware and software</label></p>
<blockquote>
<p>access to the hardware = game over?</p>
</blockquote>
<ul>
<li>Are there tamper-proof / tamper-evident design possibilities?</li>
<li>What about some sort of &ldquo;Secure Element&rdquo;</li>
<li>Or read protection?</li>
<li>Choice of OS</li>
<li>Choice of auth implementation (e.g. <code>vinda</code>)</li>
<li>Limitation on what programs are allowed to execute?</li>
</ul>
</section><section>
<p>‚úÖ <label>The Good Things</label></p>
<ul>
<li>An effort to restrict SSH access via <code>iptables</code></li>
<li>AuthN / AuthZ is present within interfaces to the device</li>
<li>UART shell requires a password</li>
<li>Logs are encrypted locally</li>
</ul>
</section>
</section><section>
<h1 id=current-challenges>Current Challenges</h1>
<section data-shortcode-section>
<blockquote>
<p>Intercepting encrypted data / TLS traffic</p>
</blockquote>
<ul>
<li>Ubuntu 14.04 has some issues (?)
<ul>
<li><code>PolarProxy</code> is too new (libc requirements)</li>
<li>apt update doesn&rsquo;t work with socks5:// or http proxies properly???</li>
</ul>
</li>
<li>Routing?</li>
<li>Hook into the encryption/decryption process somehow?
<ul>
<li>Use <code>Frida</code>?</li>
<li>Or look at the data communicated by the smartphone app?
<ul>
<li><code>Objection</code> tool didn&rsquo;t work with the RoboRock app</li>
</ul>
</li>
</ul>
</li>
</ul>
</section><section>
<blockquote>
<p>Electricity is funny.</p>
</blockquote>
<p>Using my main personal computer is not a good idea for a test-bench&mldr;<br>
üëè Thank you Gigabyte for having ESD-protected USB ports</p>
<p><img round src=../../uploads/20220501_031636.jpg></p>
</section><section>
<blockquote>
<p>Still a lot of files to look at</p>
</blockquote>
<p>Need to figure out which files are worthwhile to inspect..</p>
</section><section>
<p><label>File Inspection Approach 1 - Filter by date modified</label></p>
<blockquote>
<p>Ubuntu 14.04.3 LTS was released back in 2014, any changes would have a later timestamp (hopefully)</p>
</blockquote>
<div style=display:flex;flex-direction:row>
<div><img src=../../uploads/20220501-ubuntu_release_date.png></div>
<div><img src=../../uploads/Snipaste_2022-05-01_06-43-50.jpg alt="sort by date might give some clues"></div>
</div>
</section><section>
<p><label>File Inspection Approach 2 - Binary Comparisons</label></p>
<div style=display:flex;flex-direction:row;align-items;center>
<div style=width:65%><img src=../../uploads/20220501-ubuntu_14.04.3.png></div>
<div>
<p>Compare executable files and find<br>
differences in binary function</p>
<p><a href=https://www.zynamics.com/software.html>bindiff</a>, <a href=https://github.com/ReFirmLabs/binwalk>binwalk</a>, <a href=https://github.com/ssdeep-project/ssdeep>ssdeep</a>, <a href=https://github.com/sdhash/sdhash>sdhash</a></p>
<p><small>As seen in <label>A Large-Scale Analysis of the Security of Embedded Firmwares</label> - Andrei C, Jonas Z, Aur&rsquo;elien F, Davide B</small></p>
</div>
</div>
<aside class=notes><p>From literature review</p>
</aside>
</section>
</section><section>
<h1 id=thesis-b-retrospective>Thesis B Retrospective</h1>
<ul>
<li>Time management - could have done more work
<ul>
<li>Busy / other commitments</li>
<li>Hardware work restricts me to only working at home</li>
</ul>
</li>
<li>Project breadth / depth / scope
<ul>
<li>Binary analysis takes a lot of time</li>
</ul>
</li>
</ul>
<span class=fragment><p><label>Response</label></p>
<ul>
<li>Schedule more focus times</li>
<li>Hardware work pretty much completed - likely able to work remotely now</li>
<li>Restrict binary analysis to the most likely binaries
<ul>
<li>May consequently miss something</li>
</ul>
</li>
</ul>
</span>
<aside class=notes><p>These could possibly just be excuses</p>
</aside>
</section><section>
<h4 id=labelthesis-b-completionlabel><label>Thesis B Completion</label></h4>
<ul>
<li>Analysis of firmware binaries to identify vulnerabilities
<ul>
<li>Still in progress</li>
</ul>
</li>
<li>Search for unsecured secrets, logs, configurations
<ul>
<li>Completed (excluding encrypted <code>rrlog</code> files)</li>
</ul>
</li>
</ul>
<h4 id=labelrevised-thesis-c-planlabel><label>Revised Thesis C Plan</label></h4>
<ul>
<li>(priority) Inspection of outbound WAN traffic - security, PII, etc</li>
<li><s style=color:grey>Inspection of LAN traffic</s> rather, see if it is stored</li>
<li><s style=color:grey>Inspection of interaction with nearby devices</s></li>
<li><s style=color:grey>Protocol analysis</s></li>
<li>Update to a newer firmware version and look at changes</li>
<li>Check what files gets cleared during a format</li>
<li>Binary assessment</li>
<li>Verify IPv6 SSH access</li>
</ul>
</section><section>
<h2 id=incoming-timeline>Incoming Timeline</h2>
<ul>
<li><label>22T2 W1</label> - IPv6 SSH verification, continue binary assessment</li>
<li><label>22T2 W2</label> - WAN traffic analysis
<ul>
<li>Look at network behaviour</li>
<li>Try view WAN data pre-encryption / post-decryption</li>
</ul>
</li>
<li><label>22T2 W4</label> - Update to latest version (and hope we don&rsquo;t get locked out)
<ul>
<li>Do another vacuum clean, reimage, compare binaries</li>
</ul>
</li>
<li><label>22T2 W5</label> - Factory reset device, check for remnant files</li>
<li><label>22T2 W8</label> - Demo submission</li>
<li><label>22T2 W11</label> - Report submission</li>
</ul>
</section><section>
<h1 id=thank-you>Thank You</h1>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br></p>
<hr>
<p>Andrew Wong</p>
<sub>
<p>w: <a href=https://featherbear.cc/UNSW-CSE-Thesis>featherbear.cc/UNSW-CSE-Thesis</a></p>
<p>e: <script>document.write(atob('YW5kcmV3Lmoud29uZ0BzdHVkZW50LnVuc3cuZWR1LmF1'))</script></p>
</sub>
</section>
</div>
</div>
<script type=text/javascript src=../../reveal-hugo/object-assign.js></script>
<a href=../../reveal-js/css/print/ id=print-location style=display:none></a>
<script type=text/javascript>var printLocationElement=document.getElementById('print-location'),link=document.createElement('link');link.rel='stylesheet',link.type='text/css',link.href=printLocationElement.href+(window.location.search.match(/print-pdf/gi)?'pdf.css':'paper.css'),document.getElementsByTagName('head')[0].appendChild(link)</script>
<script type=application/json id=reveal-hugo-site-params>{"center":false,"custom_theme":"presentations/theme.scss","custom_theme_compile":true,"dependencies":[{"src":"../plugins/capsLockKeymod.js"}],"history":true,"pdf_separate_fragments":true,"slide_number":true,"width":1024}</script>
<script type=application/json id=reveal-hugo-page-params>null</script>
<script src=../../reveal-js/js/reveal.js></script>
<script type=text/javascript>var revealHugoDefaults,revealHugoSiteParams,revealHugoPageParams,options;function camelize(a){return a&&Object.keys(a).forEach(function(b){newK=b.replace(/(\_\w)/g,function(a){return a[1].toUpperCase()}),newK!=b&&(a[newK]=a[b],delete a[b])}),a}revealHugoDefaults={center:!0,controls:!0,history:!0,progress:!0,transition:"slide"},revealHugoSiteParams=JSON.parse(document.getElementById('reveal-hugo-site-params').innerHTML),revealHugoPageParams=JSON.parse(document.getElementById('reveal-hugo-page-params').innerHTML),options=Object.assign({},camelize(revealHugoDefaults),camelize(revealHugoSiteParams),camelize(revealHugoPageParams)),Reveal.initialize(options)</script>
<script type=text/javascript src=../../reveal-js/plugin/markdown/marked.js></script>
<script type=text/javascript src=../../reveal-js/plugin/markdown/markdown.js></script>
<script type=text/javascript src=../../reveal-js/plugin/highlight/highlight.js></script>
<script type=text/javascript src=../../reveal-js/plugin/zoom-js/zoom.js></script>
<script type=text/javascript src=../../reveal-js/plugin/notes/notes.js></script>
<script type=text/javascript>for(let a of document.querySelectorAll(".reveal .slides > section"))a.dataset.transition||(a.dataset.transition="fade-out slide-in");document.querySelectorAll('p img').forEach(b=>{if(b.alt!='center')return;let a=b;while(a.tagName!='P')a=a.parentNode;a.style.textAlign='center'})</script>
</body>
</html>