<!doctype html><html lang=en><meta charset=utf-8>
<meta name=viewport content="width=device-width">
<title>Points of Contact | CSE Thesis Musings</title>
<meta name=generator content="Hugo Eureka 0.8.2">
<link rel=stylesheet href=../../css/eureka.min.css>
<script defer src=../../js/eureka.min.js></script>
<link rel=preconnect href=https://fonts.gstatic.com crossorigin>
<link rel=preload href="https://fonts.googleapis.com/css2?family=Lora:wght@400;600;700&family=Noto+Serif+SC:wght@400;600;700&display=swap" as=style onload="this.onload=null,this.rel='stylesheet'">
<link rel=stylesheet href=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.1.0/build/styles/solarized-light.min.css media=print onload="this.media='all',this.onload=null" crossorigin>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.1.0/build/highlight.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.1.0/build/languages/dart.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/js/all.min.js integrity="sha256-uNYoXefWRqv+PsIF/OflNmwtKM4lStn9yrz2gVl6ymo=" crossorigin></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css integrity=sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X media=print onload="this.media='all',this.onload=null" crossorigin>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js integrity=sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4 crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js integrity=sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa crossorigin></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script>
<script defer src=https://cdn.jsdelivr.net/npm/mermaid@8.9.2/dist/mermaid.min.js integrity="sha256-Zmpaaj+GXFsPF5WdPArSrnW3b30dovldeKsW00xBVwE=" crossorigin></script>
<link rel=preconnect href=https://www.google-analytics.com crossorigin>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-107434487-2"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','UA-107434487-2')</script>
<script>(function(e,b,f,c,a,d){b[c]=b[c]||function(){(b[c].q=b[c].q||[]).push(arguments)},a=e.createElement('script'),d=e.getElementsByTagName('script')[0],a.async=1,a.src=f,a.id='fathom-script',d.parentNode.insertBefore(a,d)})(document,window,'//ss.featherbear.cc/tracker.js','fathom'),fathom('set','siteId','NEQTU'),fathom('trackPageview')</script>
<style>html.dark{--color-primary-bg:#232327 !important}div#sidebar-toc>ul.pl-6{margin-left:1em}</style>
<meta name=description content="A running list of things to probe into">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"/posts/"},{"@type":"ListItem","position":2,"name":"Points of Contact","item":"/posts/points-of-contact/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/points-of-contact/"},"headline":"Points of Contact | CSE Thesis Musings","datePublished":"2021-10-05T08:14:37+00:00","dateModified":"2021-10-05T08:14:37+00:00","wordCount":859,"publisher":{"@type":"Person","name":"A. Wong"},"description":"A running list of things to probe into"}</script><meta property="og:title" content="Points of Contact | CSE Thesis Musings">
<meta property="og:type" content="article">
<meta property="og:url" content="/posts/points-of-contact/">
<meta property="og:description" content="A running list of things to probe into">
<meta property="og:locale" content="en">
<meta property="og:site_name" content="CSE Thesis Musings">
<meta property="article:published_time" content="2021-10-05T08:14:37+00:00">
<meta property="article:modified_time" content="2021-10-05T08:14:37+00:00">
<meta property="article:section" content="posts">
<body class="flex flex-col min-h-screen">
<header class="fixed flex items-center w-full min-h-16 pl-scrollbar z-50 bg-secondary-bg shadow-sm">
<div class="w-full max-w-screen-xl mx-auto"><script>let storageColorScheme=localStorage.getItem("lightDarkMode");((storageColorScheme=='Auto'||storageColorScheme==null)&&window.matchMedia("(prefers-color-scheme: dark)").matches||storageColorScheme=="Dark")&&document.getElementsByTagName('html')[0].classList.add('dark')</script>
<nav class="flex items-center justify-between flex-wrap px-4 py-4 md:py-0">
<a href=../../ class="mr-6 text-primary-text text-xl font-bold">CSE Thesis Musings</a>
<button id=navbar-btn class="md:hidden flex items-center px-3 py-2" aria-label="Open Navbar">
<i class="fas fa-bars"></i>
</button>
<div id=target class="hidden block md:flex md:flex-grow md:justify-between md:items-center w-full md:w-auto text-primary-text z-20">
<div class="md:flex md:h-16 text-sm md:flex-grow pb-4 md:pb-0 border-b md:border-b-0">
<a href=../../#about class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent mr-4">About</a>
<a href=../../posts/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 selected-menu-item mr-4">Posts</a>
<a href=../../docs/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent mr-4">Docs</a>
</div>
<div class=flex>
<div class="relative pt-4 md:pt-0">
<div class="cursor-pointer hover:text-eureka" id=lightDarkMode>
<i class="fas fa-adjust"></i>
</div>
<div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-30" id=is-open>
</div>
<div class="absolute flex flex-col left-0 md:left-auto right-auto md:right-0 hidden bg-secondary-bg w-48 rounded py-2 border border-tertiary-bg cursor-pointer z-40" id=lightDarkOptions>
<span class="px-4 py-1 hover:text-eureka" name=Light>Light</span>
<span class="px-4 py-1 hover:text-eureka" name=Dark>Dark</span>
<span class="px-4 py-1 hover:text-eureka" name=Auto>Auto</span>
</div>
</div>
</div>
</div>
<div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-0" id=is-open-mobile>
</div>
</nav>
<script>let element=document.getElementById('lightDarkMode');storageColorScheme==null||storageColorScheme=='Auto'?document.addEventListener('DOMContentLoaded',()=>{window.matchMedia("(prefers-color-scheme: dark)").addEventListener('change',switchDarkMode)}):storageColorScheme=="Light"?(element.firstElementChild.classList.remove('fa-adjust'),element.firstElementChild.setAttribute("data-icon",'sun'),element.firstElementChild.classList.add('fa-sun')):storageColorScheme=="Dark"&&(element.firstElementChild.classList.remove('fa-adjust'),element.firstElementChild.setAttribute("data-icon",'moon'),element.firstElementChild.classList.add('fa-moon')),document.addEventListener('DOMContentLoaded',()=>{getcolorscheme(),switchBurger()})</script>
</div>
</header>
<main class="flex-grow pt-16">
<div class=pl-scrollbar>
<div class="w-full max-w-screen-xl lg:px-4 xl:px-8 mx-auto">
<div class="grid grid-cols-2 lg:grid-cols-8 gap-4 lg:pt-12">
<div class="col-span-2 lg:col-span-6 bg-secondary-bg rounded px-6 py-8">
<h1 class="font-bold text-3xl text-primary-text">Points of Contact</h1>
<div class="flex flex-wrap flex-row items-center mt-2 text-tertiary-text">
<div class="mr-6 my-2">
<i class="fas fa-calendar mr-1"></i>
<span>2021-10-05</span>
</div>
</div>
<div class=content>
<h3 id=wireless-device-pairing>Wireless Device Pairing</h3>
<p>When pairing the device over WiFi (for initial setup), the device acts as a wireless AP and hosts a wireless network <code>roborock-***</code>. Using a smartphone (with the Mi Home app) we can connect to this network, in order to transfer the configuration data.</p>
<ul>
<li>Figure out what data is being sent by the vacuum cleaner</li>
<li>Figure out what data is being sent by the Mi Home app</li>
<li>Probably it is a standard protocol
<ul>
<li>MIoT</li>
<li><a href=https://github.com/OpenMiHome/mihome-binary-protocol/blob/master/doc/PROTOCOL.md>miIO</a></li>
<li><a href=https://github.com/rytilahti/python-miio title=https://github.com/rytilahti/python-miio>https://github.com/rytilahti/python-miio</a></li>
</ul>
</li>
</ul>
<blockquote>
<p>For example, gen1 rockrobo vacuums do not respond to the info query when offline, some devices do not respond with correct payloads (<a href=https://github.com/rytilahti/python-miio/issues/334#issuecomment-907930736>rytilahti/python-miio#334 (comment)</a>), and some do not even respond to the initial handshake queries (<a href=https://python-miio.readthedocs.io/en/latest/troubleshooting.html#intermittent-connection-issues-timeouts-xiaomi-vacuum title=https://python-miio.readthedocs.io/en/latest/troubleshooting.html#intermittent-connection-issues-timeouts-xiaomi-vacuum>https://python-miio.readthedocs.io/en/latest/troubleshooting.html#intermittent-connection-issues-timeouts-xiaomi-vacuum</a>).</p>
</blockquote>
<p>Device might not respond without an active network connection?</p>
<h1 id=roborock-cpu>Roborock CPU</h1>
<p>ARM Cortex-A?<br>
ARM Cortex-M?<br>
Marvell 88MW30X (wifi)<br>
Mediatek MT7687N (wifi + ble)<br>
MIPS</p>
<h1 id=cloud-protocol>Cloud Protocol</h1>
<ul>
<li>DeviceID - unique per device</li>
<li>Keys
<ul>
<li>Cloud key (16 byte alphanum)
<ul>
<li>Used in cloud comms (AES)</li>
<li>Static</li>
</ul>
</li>
<li>Token (16 byte alphanum)
<ul>
<li>App communication (AES)</li>
<li>Dynamic (created when new WiFi setup)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id=different-vendors-one-ecosystem>Different vendors, one ecosystem</h1>
<blockquote>
<p><a href=https://dontvacuum.me/talks/DEFCON26-IoT-Village/DEFCON26-IoT-Village_How_to_Modify_Cortex_M_Firmware-Xiaomi.html title=https://dontvacuum.me/talks/DEFCON26-IoT-Village/DEFCON26-IoT-Village_How_to_Modify_Cortex_M_Firmware-Xiaomi.html>https://dontvacuum.me/talks/DEFCON26-IoT-Village/DEFCON26-IoT-Village_How_to_Modify_Cortex_M_Firmware-Xiaomi.html</a></p>
</blockquote>
<ul>
<li>Same communication protocol</li>
<li>Different technologies supported</li>
<li>Implementation differs from manufacturers
<ul>
<li>Software quality very different</li>
</ul>
</li>
</ul>
<h1 id=useful-links>Useful Links</h1>
<h3 id=emulate-the-mi-cloud-server>Emulate the Mi Cloud server</h3>
<ul>
<li>Rooting Information
<ul>
<li><a href="https://www.youtube.com/watch?v=r_04K5SPEXI" title="https://www.youtube.com/watch?v=r_04K5SPEXI">https://www.youtube.com/watch?v=r_04K5SPEXI</a></li>
<li><a href=https://builder.dontvacuum.me/x6cheatsheet.txt title=https://builder.dontvacuum.me/x6cheatsheet.txt>https://builder.dontvacuum.me/x6cheatsheet.txt</a></li>
</ul>
</li>
</ul>
<p><a href=https://media.ccc.de/v/34c3-9147-unleash_your_smart-home_devices_vacuum_cleaning_robot_hacking title=https://media.ccc.de/v/34c3-9147-unleash_your_smart-home_devices_vacuum_cleaning_robot_hacking>https://media.ccc.de/v/34c3-9147-unleash_your_smart-home_devices_vacuum_cleaning_robot_hacking</a></p>
<p><a href=https://dontvacuum.me/talks/DEFCON26/DEFCON26-Having_fun_with_IoT-Xiaomi.pdf title=https://dontvacuum.me/talks/DEFCON26/DEFCON26-Having_fun_with_IoT-Xiaomi.pdf>https://dontvacuum.me/talks/DEFCON26/DEFCON26-Having_fun_with_IoT-Xiaomi.pdf</a></p>
<p><a href="https://www.youtube.com/playlist?list=PL9PoaNtZCJRZc61c792VCr_I6jQK_IdSb" title="https://www.youtube.com/playlist?list=PL9PoaNtZCJRZc61c792VCr_I6jQK_IdSb">https://www.youtube.com/playlist?list=PL9PoaNtZCJRZc61c792VCr_I6jQK_IdSb</a></p>
<p><a href="https://www.youtube.com/watch?v=r_04K5SPEXI" title="https://www.youtube.com/watch?v=r_04K5SPEXI">https://www.youtube.com/watch?v=r_04K5SPEXI</a></p>
<h1 id=firmware>Firmware</h1>
<h1 id=the-password>The Password</h1>
<p><a href=https://builder.dontvacuum.me/password.php title=https://builder.dontvacuum.me/password.php>https://builder.dontvacuum.me/password.php</a></p>
<blockquote>
<p>&ldquo;Technical background: If you dont trust this tool, you can convert the vinda file yourself by XOR&rsquo;ing every character with &ldquo;0x37&rdquo;. The resulting string should be all lowercase letters.&rdquo;</p>
</blockquote>
<h2 id=pulling-the-firmware>Pulling The Firmware</h2>
<p>Firmware is encrypted and signed!?!??!?! noooooo?<br>
Tuya integration?</p>
<p>OS: Ubuntu 14.04.3</p>
<h2 id=on-board-software>On-board Software</h2>
<p><code>rr_loader</code> (Player 3.10)</p>
<p><code>/opt/roborock</code></p>
<ul>
<li><code>AppProxy</code></li>
<li><code>miIO-client/tuya-client</code></li>
<li><code>SysUpdate</code></li>
<li><code>adbd</code></li>
</ul>
<h2 id=firewall>Firewall</h2>
<p>SSH (22) and player (6665) blocked<br>
IPv6 blocked</p>
<p>Two separate apps Mi Home (MiIO) / Roborock (Tuya)</p>
<p>11:25 - <a href="https://www.youtube.com/watch?v=r_04K5SPEXI" title="https://www.youtube.com/watch?v=r_04K5SPEXI">https://www.youtube.com/watch?v=r_04K5SPEXI</a></p>
<p>Hold S whilst rebooting on the UART</p>
<p>then press middle button for 3s??</p>
<h2 id=dumping-spi-flash>Dumping SPI Flash</h2>
<p>JTAG, SWD - Can use a RaspPi with OpenOCD<br>
Desolder the flash; use flashrom<br>
Chips with secure boot?</p>
<h2 id=ota-updates>OTA Updates</h2>
<ul>
<li>Intercept traffic, but block the actual update</li>
<li>The device might not be using DNS, or might fallback to IP regardless</li>
<li>SSL? Cert.. or deny enough times?</li>
<li>CDN with authentication</li>
</ul>
<h1 id=re-the-firmware>RE the firmware</h1>
<p>Reverse engineer the firmware by using the official SDK and compiling - then figuring out what it does?</p>
<p>i.e Marvell MW30X - afx2firmware</p>
<h1 id=useful-analysis-software>(Useful?) Analysis Software</h1>
<h2 id=bindiff>bindiff</h2>
<blockquote>
<p>Zynamics acquired by google in 2011</p>
</blockquote>
<blockquote>
<h2 id=zynamics-acquired-by-google-httpblogzynamicscom20110301zynamics-acquired-by-google-permanent-link-to-zynamics-acquired-by-google-><a href=http://blog.zynamics.com/2011/03/01/zynamics-acquired-by-google/ title="Permanent Link to zynamics acquired by Google !">zynamics acquired by Google !</a></h2>
<p><a href=http://blog.zynamics.com/2011/03/01/zynamics-acquired-by-google/ title=http://blog.zynamics.com/2011/03/01/zynamics-acquired-by-google/>http://blog.zynamics.com/2011/03/01/zynamics-acquired-by-google/</a></p>
</blockquote>
<ul>
<li><a href=https://security.googleblog.com/2016/03/bindiff-now-available-for-free.html title=https://security.googleblog.com/2016/03/bindiff-now-available-for-free.html>https://security.googleblog.com/2016/03/bindiff-now-available-for-free.html</a></li>
<li><a href=https://github.com/google/binnavi title=https://github.com/google/binnavi>https://github.com/google/binnavi</a></li>
<li><a href=https://github.com/google/binexport title=https://github.com/google/binexport>https://github.com/google/binexport</a></li>
</ul>
<p>FW Updates replace the entire partition</p>
<p>CLI via serial - <code>updatefw ___</code></p>
<p>SWD - dump</p>
<p>Bindiff viewer for Binary Ninja - <a href=https://github.com/PistonMiner/binaryninja-bindiff-viewer title=https://github.com/PistonMiner/binaryninja-bindiff-viewer>https://github.com/PistonMiner/binaryninja-bindiff-viewer</a></p>
<h2 id=nexmon>nexmon</h2>
<blockquote>
<p>Binary / Firmware patching</p>
</blockquote>
<p>Binary Diff Tool - <a href=https://github.com/joxeankoret/diaphora title=https://github.com/joxeankoret/diaphora>https://github.com/joxeankoret/diaphora</a></p>
<p>Helps to</p>
<ul>
<li>Overwrite branch instructions</li>
<li>Write new code</li>
<li>Model the address space (i.e. RAM, ROM, Free space)</li>
<li>Call existing functions</li>
<li>handle different firmware versions and devices</li>
</ul>
<blockquote>
<p>how do people test firmware on a embedded system?</p>
</blockquote>
<h2 id=other>Other</h2>
<p>Firmware Analysis and Comparison Tool - <a href=https://github.com/fkie-cad/FACT_core title=https://github.com/fkie-cad/FACT_core>https://github.com/fkie-cad/FACT_core</a></p>
<p><a href=https://github.com/rampageX/firmware-mod-kit title=https://github.com/rampageX/firmware-mod-kit>https://github.com/rampageX/firmware-mod-kit</a></p>
<h1 id=previous-research>Previous Research</h1>
<blockquote>
<p>Dennis Giese - Don&rsquo;t Vacuum Me</p>
</blockquote>
<ul>
<li><a href=https://dontvacuum.me/ title=https://dontvacuum.me/>https://dontvacuum.me/</a></li>
<li><a href=https://dontvacuum.me/ title=https://dontvacuum.me/>https://builder.dontvacuum.me/</a></li>
<li><a href=https://dontvacuum.me/ title=https://dontvacuum.me/>https://builder.dontvacuum.me/_s6.html</a></li>
<li><a href=https://dontvacuum.me/robotinfo/firmwares/roborock.vacuum.s6.html title=https://dontvacuum.me/robotinfo/firmwares/roborock.vacuum.s6.html>https://dontvacuum.me/robotinfo/firmwares/roborock.vacuum.s6.html</a></li>
<li><a href=https://dontvacuum.me/robotinfo/configfiles/roborock.s6/ title=https://dontvacuum.me/robotinfo/configfiles/roborock.s6/>https://dontvacuum.me/robotinfo/configfiles/roborock.s6/</a></li>
<li><a href=https://dontvacuum.me/teardowns/roborock.vacuum.x6/ title=https://dontvacuum.me/teardowns/roborock.vacuum.x6/>https://dontvacuum.me/teardowns/roborock.vacuum.x6/</a></li>
<li><a href=https://dontvacuum.me/thesis/ title=https://dontvacuum.me/thesis/>https://dontvacuum.me/thesis/</a></li>
<li><a href=https://dontvacuum.me/thesis/Security_Analysis_of_the_Xiaomi_IoT_Ecosystem.pdf title=https://dontvacuum.me/thesis/Security_Analysis_of_the_Xiaomi_IoT_Ecosystem.pdf>https://dontvacuum.me/thesis/Security_Analysis_of_the_Xiaomi_IoT_Ecosystem.pdf</a></li>
<li><a href=https://dontvacuum.me/thesis/2019-09-masterthesis-defensetalk.pdf title=https://dontvacuum.me/thesis/2019-09-masterthesis-defensetalk.pdf>https://dontvacuum.me/thesis/2019-09-masterthesis-defensetalk.pdf</a></li>
</ul>
<hr>
<p><a href=https://www.roboter-forum.com/index.php?board/163-roborock-s6/ title=https://www.roboter-forum.com/index.php?board/163-roborock-s6/>https://www.roboter-forum.com/index.php?board/163-roborock-s6/</a></p>
<h1 id=custom-software>Custom Software</h1>
<h2 id=valetudo>Valetudo</h2>
<p><a href=https://www.reddit.com/r/homeassistant/comments/fdrcz0/how_to_install_valetudo_re_on_a_xiaomi_robot/ title=https://www.reddit.com/r/homeassistant/comments/fdrcz0/how_to_install_valetudo_re_on_a_xiaomi_robot/>https://www.reddit.com/r/homeassistant/comments/fdrcz0/how_to_install_valetudo_re_on_a_xiaomi_robot/</a></p>
<p><a href=https://valetudo.cloud/ title=https://valetudo.cloud/>https://valetudo.cloud/</a></p>
<h2 id=dust-cloud>Dust Cloud</h2>
<p><a href=https://github.com/unrelentingtech/micloudfaker title=https://github.com/unrelentingtech/micloudfaker>https://github.com/dgiese/dustcloud</a></p>
<h2 id=flole>Flole</h2>
<p><a href=https://xiaomi.flole.de/ title=https://xiaomi.flole.de/>https://xiaomi.flole.de/</a></p>
<h2 id=others>Others</h2>
<p><a href=https://github.com/unrelentingtech/micloudfaker title=https://github.com/unrelentingtech/micloudfaker>https://github.com/unrelentingtech/micloudfaker</a></p>
<h2 id=proto>Proto</h2>
<p><a href=https://github.com/OpenMiHome/mihome-binary-protocol/blob/master/doc/PROTOCOL.md title=https://github.com/OpenMiHome/mihome-binary-protocol/blob/master/doc/PROTOCOL.md>https://github.com/OpenMiHome/mihome-binary-protocol/blob/master/doc/PROTOCOL.md</a></p>
<blockquote>
<p><code>mirobo --debug discover --handshake true</code></p>
</blockquote>
<p><a href=https://github.com/marcelrv/XiaomiRobotVacuumProtocol title=https://github.com/marcelrv/XiaomiRobotVacuumProtocol>https://github.com/marcelrv/XiaomiRobotVacuumProtocol</a></p>
<p><a href=https://github.com/rytilahti/python-miio title=https://github.com/rytilahti/python-miio>https://github.com/rytilahti/python-miio</a></p>
<p><a href=https://www.yeelight.com/download/Yeelight_Inter-Operation_Spec.pdf title=https://www.yeelight.com/download/Yeelight_Inter-Operation_Spec.pdf>https://www.yeelight.com/download/Yeelight_Inter-Operation_Spec.pdf</a></p>
<h1 id=vacuum-cleaner-runs-linux>Vacuum Cleaner&mldr; runs&mldr; Linux????</h1>
<ul>
<li><a href=https://www.reddit.com/r/linux/comments/7y9ddk/is_your_robot_vacuum_cleaner_running_ubuntu_1404/ title=https://www.reddit.com/r/linux/comments/7y9ddk/is_your_robot_vacuum_cleaner_running_ubuntu_1404/>https://www.reddit.com/r/linux/comments/7y9ddk/is_your_robot_vacuum_cleaner_running_ubuntu_1404/</a></li>
<li><a href=https://medium.com/@anxodio/how-to-get-spotify-working-on-your-xiaomi-vacuum-da28c52bbb4e title=https://medium.com/@anxodio/how-to-get-spotify-working-on-your-xiaomi-vacuum-da28c52bbb4e>https://medium.com/@anxodio/how-to-get-spotify-working-on-your-xiaomi-vacuum-da28c52bbb4e</a></li>
<li><a href=https://www.cnx-software.com/2021/01/20/valetudo-is-a-cloud-free-web-interface-for-robot-vacuum-cleaners/ title=https://www.cnx-software.com/2021/01/20/valetudo-is-a-cloud-free-web-interface-for-robot-vacuum-cleaners/>https://www.cnx-software.com/2021/01/20/valetudo-is-a-cloud-free-web-interface-for-robot-vacuum-cleaners/</a></li>
</ul>
<p><a href=https://github.com/LazyT/rrcc title=https://github.com/LazyT/rrcc>https://github.com/LazyT/rrcc</a></p>
<p><a href=https://github.com/pezema/home-vacuum title=https://github.com/pezema/home-vacuum>https://github.com/pezema/home-vacuum</a></p>
<h1 id=mikrotik-wireshark>MikroTik Wireshark</h1>
<p>(I can use my MikroTik router to packet sniff by IP or MAC)<br>
(Note: Will only send WAN packets, as local packets would be switched without reaching the router?)</p>
<p><a href=https://tojaj.com/packet-capture-from-mikrotik-to-wireshark/ title=https://tojaj.com/packet-capture-from-mikrotik-to-wireshark/>https://tojaj.com/packet-capture-from-mikrotik-to-wireshark/</a></p>
<p><a href="https://www.youtube.com/watch?v=zj2vLZOVOT0" title="https://www.youtube.com/watch?v=zj2vLZOVOT0">https://www.youtube.com/watch?v=zj2vLZOVOT0</a></p>
<p><a href=https://mikrotik.com/download/trafr.tgz title=https://mikrotik.com/download/trafr.tgz>https://mikrotik.com/download/trafr.tgz</a></p>
<p><a href=https://github.com/thefloweringash/tzsp2pcap title=https://github.com/thefloweringash/tzsp2pcap>https://github.com/thefloweringash/tzsp2pcap</a></p>
<p><a href="https://forum.mikrotik.com/viewtopic.php?p=727384#p727384" title="https://forum.mikrotik.com/viewtopic.php?p=727384#p727384">https://forum.mikrotik.com/viewtopic.php?p=727384#p727384</a></p>
<h1 id=post-exploitation-todos>Post-Exploitation TODOs</h1>
<ul>
<li>/run/shm - memory</li>
<li>/mnt/default -> ???</li>
<li></li>
</ul>
<h1 id=public-security>Public Security</h1>
<p><a href=https://www.reddit.com/r/privacy/comments/bb0tz3/safe_use_of_the_xiaomi_roborock/ title=https://www.reddit.com/r/privacy/comments/bb0tz3/safe_use_of_the_xiaomi_roborock/>https://www.reddit.com/r/privacy/comments/bb0tz3/safe_use_of_the_xiaomi_roborock/</a></p>
<p><a href=https://www.reddit.com/r/homeautomation/comments/bcpnr8/the_most_secure_private_robot_vacuum_cleaner_ie/ title=https://www.reddit.com/r/homeautomation/comments/bcpnr8/the_most_secure_private_robot_vacuum_cleaner_ie/>https://www.reddit.com/r/homeautomation/comments/bcpnr8/the_most_secure_private_robot_vacuum_cleaner_ie/</a></p>
<p><a href="https://www.youtube.com/watch?v=uhyM-bhzFsI" title="https://www.youtube.com/watch?v=uhyM-bhzFsI">https://www.youtube.com/watch?v=uhyM-bhzFsI</a></p>
<p><a href=https://media.ccc.de/v/34c3-9147-unleash_your_smart-home_devices_vacuum_cleaning_robot_hacking title=https://media.ccc.de/v/34c3-9147-unleash_your_smart-home_devices_vacuum_cleaning_robot_hacking>https://media.ccc.de/v/34c3-9147-unleash_your_smart-home_devices_vacuum_cleaning_robot_hacking</a></p>
<p><a href=https://www.consumerreports.org/robotic-vacuums/is-your-robotic-vacuum-sharing-data-about-you-a1563001307/ title=https://www.consumerreports.org/robotic-vacuums/is-your-robotic-vacuum-sharing-data-about-you-a1563001307/>https://www.consumerreports.org/robotic-vacuums/is-your-robotic-vacuum-sharing-data-about-you-a1563001307/</a></p>
<ul>
<li><a href=https://blog.avast.com/locking-down-smart-home-security-avast title=https://blog.avast.com/locking-down-smart-home-security-avast>https://blog.avast.com/locking-down-smart-home-security-avast</a>
<ul>
<li>
<p>The Roborock vacuum, on the other hand, is sketchy. This is the only device that I’d actually prefer we didn’t have in our home, because I really don’t trust the parent company to use the information it gathers responsibly. We actually moved recently and haven’t used it since settling into our new place — and I’d like to keep it that way.</p>
<p>But, just in case, I made sure that the Roborock vacuum is connected to a guest network, which has a different password than our main network. That way it at least can’t compromise our main network (and everything else that’s on it) if there’s ever a security breach.</p>
</li>
</ul>
</li>
</ul>
<p><a href=https://www.reddit.com/r/homeautomation/comments/l24jj4/roborock_securitysetup_guest_network_enough/ title=https://www.reddit.com/r/homeautomation/comments/l24jj4/roborock_securitysetup_guest_network_enough/>https://www.reddit.com/r/homeautomation/comments/l24jj4/roborock_securitysetup_guest_network_enough/</a></p>
<p><a href=https://builder.dontvacuum.me/x6howtoroot.pdf title=https://builder.dontvacuum.me/x6howtoroot.pdf>https://builder.dontvacuum.me/x6howtoroot.pdf</a></p>
<p>50 million connected devices - tech crunch</p>
<p>revenue > 15B yuan</p>
<p>What makes something &ldquo;secure&rdquo;?</p>
<p>&ldquo;How secure is the implementation of the ecosystem of the IoT market leader Xiaomi?&rdquo;</p>
<p>&ldquo;– Will be introduced in November 2019&rdquo; Xiaomi</p>
<h1 id=device-info>Device Info</h1>
<ul>
<li>Model Name - Roborock S6</li>
<li>Model ID - roborock.vacuum.s6</li>
<li>Codename - tanos</li>
<li>Firmware - A=enc(AES-256-CBC), signed (RSA)</li>
<li>Sound Files - A=enc, signed</li>
<li>SoC - Allwinner R16 (4x)</li>
<li>RAM - 512 MByte</li>
<li>Flash - 4GByte eMMC</li>
<li>MCU - WiFi STM32F103VCT6</li>
<li>WiFi - RTL8189ETV</li>
<li>OS (Kernel) - Ubuntu 14.04 (3.4.x)</li>
<li>Year - Q2/2018</li>
<li>Lidar - Yes</li>
<li>Camera - No</li>
<li>Mop - Yes</li>
<li>Waterpump - No</li>
<li>LIDAR-Tower Bumper - Yes</li>
<li>IR-Dropdensors - 6</li>
<li>IR-side sensors - Yes</li>
<li>Frontsensor - IR</li>
<li>Cloud - 3.5.8 / Tuya</li>
<li>Root Possible Since (Q2 2019)</li>
<li>Complexity - Disass / Simple Soldering</li>
<li>Valetudo - Yes</li>
</ul>
<hr>
<p>Device ID: 32 bits - Unique number. Possibly derived from the MAC address.</p>
<p>Replication study?</p>
<ul>
<li>Old static password (still used for sound files?) - &ldquo;r0ckrobo#23456&rdquo;</li>
<li>AEC128CBC Key for Gen2 &ldquo;RoCKR0B0@BEIJING&rdquo;</li>
<li>Factory reset<br>
– Does not delete data: Maps, Logs still exist</li>
</ul>
<p>CIA Principals</p>
</div>
<div class="flex flex-col md:flex-row md:justify-between -mx-2 mt-4 px-2 pt-4 border-t">
<div>
<span class="block font-bold">Previous</span>
<a href=../../posts/thesis-tasks/ class=block>Thesis Tasks</a>
</div>
<div class="md:text-right mt-4 md:mt-0">
<span class="block font-bold">Next</span>
<a href=../../posts/capturing-network-activity-securely/ class=block>Capturing Network Activity (Securely)</a>
</div>
</div>
</div>
<div class=col-span-2>
<div class="sticky top-16 z-10 hidden lg:block px-6 py-4 bg-primary-bg">
<span class="text-lg font-semibold">On This Page</span>
</div>
<div class="sticky-toc hidden lg:block px-6 pb-6">
<nav id=TableOfContents>
<ul>
<li>
<ul>
<li><a href=#wireless-device-pairing>Wireless Device Pairing</a></li>
</ul>
</li>
</ul>
<ul>
<li>
<ul>
<li><a href=#emulate-the-mi-cloud-server>Emulate the Mi Cloud server</a></li>
</ul>
</li>
</ul>
<ul>
<li><a href=#pulling-the-firmware>Pulling The Firmware</a></li>
<li><a href=#on-board-software>On-board Software</a></li>
<li><a href=#firewall>Firewall</a></li>
<li><a href=#dumping-spi-flash>Dumping SPI Flash</a></li>
<li><a href=#ota-updates>OTA Updates</a></li>
</ul>
<ul>
<li><a href=#bindiff>bindiff</a></li>
<li><a href=#zynamics-acquired-by-google-httpblogzynamicscom20110301zynamics-acquired-by-google-permanent-link-to-zynamics-acquired-by-google-><a href=http://blog.zynamics.com/2011/03/01/zynamics-acquired-by-google/ title="Permanent Link to zynamics acquired by Google !">zynamics acquired by Google !</a></a></li>
<li><a href=#nexmon>nexmon</a></li>
<li><a href=#other>Other</a></li>
</ul>
<ul>
<li><a href=#valetudo>Valetudo</a></li>
<li><a href=#dust-cloud>Dust Cloud</a></li>
<li><a href=#flole>Flole</a></li>
<li><a href=#others>Others</a></li>
<li><a href=#proto>Proto</a></li>
</ul>
</nav>
</div>
<script>window.addEventListener('DOMContentLoaded',()=>{enableStickyToc()})</script>
</div>
</div>
<script>document.addEventListener('DOMContentLoaded',()=>{hljs.initHighlightingOnLoad()})</script>
</div>
</div>
</main>
<footer class=pl-scrollbar>
<div class="w-full max-w-screen-xl mx-auto"><div class="text-center p-6 pin-b">
<p class="text-sm text-tertiary-text">&copy; 2021 <a href=https://featherbear.cc>Andrew Wong (z5206677)</a>
&#183; Powered by the <a href=https://github.com/wangchucheng/hugo-eureka class=hover:text-eureka>Eureka</a> theme for <a href=https://gohugo.io class=hover:text-eureka>Hugo</a></p>
</div></div>
</footer>
</body>
</html>